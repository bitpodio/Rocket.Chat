function module(e,n,t){var r,a,u,i,o,s,c,l,p,f,d,v,m;t.link("@babel/runtime/regenerator",{default:function(e){r=e}},0),t.link("@babel/runtime/helpers/objectSpread2",{default:function(e){a=e}},1),t.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){u=e}},2),t.link("@babel/runtime/helpers/createForOfIteratorHelperLoose",{default:function(e){i=e}},3),t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){o=e}},4),t.link("react",{default:function(e){s=e},useEffect:function(e){c=e},useRef:function(e){l=e},useState:function(e){p=e}},0),t.link("../../../../app/apps/client/orchestrator",{Apps:function(e){f=e}},1),t.link("../../../../app/apps/client/communication",{AppEvents:function(e){d=e}},2),t.link("./helpers",{handleAPIError:function(e){v=e}},3),t.link("./AppsContext",{AppsContext:function(e){m=e}},4);var A=function(e){for(var n=Object.entries(e),t=0,r=n;t<r.length;t++){var a,u=r[t],s=o(u,2),c=s[0],l=s[1];null===(a=f.getWsListener())||void 0===a||a.registerListener(d[c],l)}return function(){for(var e=i(n),t;!(t=e()).done;){var r,a=t.value,u=o(a,2),s=u[0],c=u[1];null===(r=f.getWsListener())||void 0===r||r.unregisterListener(d[s],c)}}},h=function(e){var n=e.children,t=p((function(){return[]})),i=o(t,2),d=i[0],h=i[1],k=p((function(){return!1})),b=o(k,2),P=b[0],g=b[1],x=l(d);x.current=d;var E=function(){h((function(e){return u(e)}))},I=function(){return x.current.slice(0)};c((function(){var e=function(e){h(e.sort((function(e,n){return e.name.toLowerCase()>n.name.toLowerCase()?1:-1}))),E()},n=function(){function e(e){var n,t,u,i,o,s;return r.async(function(){function c(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,r.awrap(f.getApp(e));case 3:return n=c.sent,t=n.status,u=n.version,c.next=8,r.awrap(f.getAppFromMarketplace(e,u));case 8:i=c.sent,o=I(),s=o.findIndex((function(n){var t;return n.id===e})),o[s]=a(a({},i),{},{installed:!0,status:t,version:u,marketplaceVersion:i.version}),h(o),E(),c.next=19;break;case 16:c.prev=16,c.t0=c.catch(0),v(c.t0);case 19:case"end":return c.stop()}}return c}(),null,null,[[0,16]],Promise)}return e}(),t,i=A({APP_ADDED:n,APP_UPDATED:n,APP_REMOVED:function(e){var n=I(),t=n.findIndex((function(n){var t;return n.id===e}));n[t]&&(!1!==n[t].marketplace?n.splice(t,1):(delete n[t].installed,delete n[t].status,n[t].version=n[t].marketplaceVersion),h(n),E())},APP_STATUS_CHANGE:function(e){var n=e.appId,t=e.status,r=I(),a=r.find((function(e){var t;return e.id===n}));a&&(a.status=t,h(r),E())},APP_SETTING_UPDATED:function(){E()}}),o;return function(){function n(){var n,t,o;return r.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,r.awrap(f.getApps().then((function(n){var t=[];return n.length&&(t=n.map((function(e){return a(a({},e),{},{installed:!0,marketplace:!1})})),e(t)),t})));case 3:return n=s.sent,s.next=6,r.awrap(f.getAppsFromMarketplace());case 6:t=s.sent,o=t.length?t.map((function(e){var t=n.findIndex((function(n){var t;return n.id===e.id}));if(!n[t])return a(a({},e),{},{status:void 0,marketplaceVersion:e.version,bundledIn:e.bundledIn});var r=n.splice(t,1).pop();return a(a(a({},e),{},{installed:!0},r&&{status:r.status,version:r.version}),{},{bundledIn:e.bundledIn,marketplaceVersion:e.version})})):[],n.length&&o.push.apply(o,u(n)),e(o),g(!0),s.next=17;break;case 13:s.prev=13,s.t0=s.catch(0),v(s.t0),i();case 17:case"end":return s.stop()}}return s}(),null,null,[[0,13]],Promise)}return n}()(),i}),[]);var D={apps:d,finishedLoading:P};return(s.createElement(m.Provider,{children:n,value:D}))};t.exportDefault(h)}

