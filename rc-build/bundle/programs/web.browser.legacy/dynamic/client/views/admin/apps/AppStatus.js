function module(e,n,t){var r,a,i,o,s,u,c,l,p,f,m,d,h,b,k,x,v,E,g,w,y,P,S,A,C;t.link("@babel/runtime/helpers/objectSpread2",{default:function(e){r=e}},0),t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){a=e}},1),t.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){i=e}},2),t.link("@babel/runtime/regenerator",{default:function(e){o=e}},3),t.link("@rocket.chat/fuselage",{Box:function(e){s=e},Button:function(e){u=e},Icon:function(e){c=e},Throbber:function(e){l=e}},0),t.link("@rocket.chat/fuselage-hooks",{useSafely:function(e){p=e}},1),t.link("react",{default:function(e){f=e},useCallback:function(e){m=e},useState:function(e){d=e},memo:function(e){h=e}},2),t.link("../../../contexts/TranslationContext",{useTranslation:function(e){b=e}},3),t.link("./helpers",{appButtonProps:function(e){k=e},appStatusSpanProps:function(e){x=e},handleAPIError:function(e){v=e},warnStatusChange:function(e){E=e},handleInstallError:function(e){g=e}},4),t.link("../../../../app/apps/client/orchestrator",{Apps:function(e){w=e}},5),t.link("./IframeModal",{default:function(e){y=e}},6),t.link("./CloudLoginModal",{default:function(e){P=e}},7),t.link("./AppPermissionsReviewModal",{default:function(e){S=e}},8),t.link("../../../contexts/ModalContext",{useSetModal:function(e){A=e}},9),t.link("../../../contexts/ServerContext",{useMethod:function(e){C=e}},10);var I=function(){function e(e){var n,t,r,a,i,s;return o.async(function(){function u(u){for(;;)switch(u.prev=u.next){case 0:return n=e.id,t=e.name,r=e.version,a=e.permissionsGranted,u.prev=1,u.next=4,o.awrap(w.installApp(n,r,a));case 4:i=u.sent,s=i.status,E(t,s),u.next=12;break;case 9:u.prev=9,u.t0=u.catch(1),v(u.t0);case 12:case"end":return u.stop()}}return u}(),null,null,[[1,9]],Promise)}return e}(),M={purchase:I,install:I,update:function(){function e(e){var n,t,r,a,i,s;return o.async(function(){function u(u){for(;;)switch(u.prev=u.next){case 0:return n=e.id,t=e.name,r=e.marketplaceVersion,a=e.permissionsGranted,u.prev=1,u.next=4,o.awrap(w.updateApp(n,r,a));case 4:i=u.sent,s=i.status,E(t,s),u.next=12;break;case 9:u.prev=9,u.t0=u.catch(1),v(u.t0);case 12:case"end":return u.stop()}}return u}(),null,null,[[1,9]],Promise)}return e}()},T=function(e){var n=e.app,t=e.showStatus,h=void 0===t||t,E=i(e,["app","showStatus"]),I=b(),T=p(d()),B=a(T,2),D=B[0],G=B[1],j=p(d(n.isPurchased)),L=a(j,2),U=L[0],z=L[1],F=A(),H=k(n),R=!H&&x(n),V=(null==H?void 0:H.action)||"",W=m((function(e){F(null),M[V](r(r({},n),{},{permissionsGranted:e})).then((function(){G(!1)}))}),[F,V,n,G]),q=m((function(){G(!1),F(null)}),[G,F]),J=function(){return U||z(!0),n.permissions&&0!==n.permissions.length?(Array.isArray(n.permissions)||g(new Error('The "permissions" property from the app manifest is invalid')),F(f.createElement(S,{appPermissions:n.permissions,cancel:q,confirm:W}))):W(n.permissions)},K=C("cloud:checkUserLoggedIn"),N=function(){function e(e){var t,r;return o.async(function(){function a(a){for(;;)switch(a.prev=a.next){case 0:return e.preventDefault(),e.stopPropagation(),G(!0),a.next=5,o.awrap(K());case 5:if(t=a.sent){a.next=10;break}return G(!1),F(f.createElement(P,null)),a.abrupt("return");case 10:if("purchase"!==V||U){a.next=22;break}return a.prev=11,a.next=14,o.awrap(w.buildExternalUrl(n.id,n.purchaseType,!1));case 14:r=a.sent,F(f.createElement(y,{url:r.url,cancel:q,confirm:J})),a.next=21;break;case 18:a.prev=18,a.t0=a.catch(11),v(a.t0);case 21:return a.abrupt("return");case 22:J();case 23:case"end":return a.stop()}}return a}(),null,null,[[11,18]],Promise)}return e}();return f.createElement(s,E,H&&f.createElement(u,{primary:!0,disabled:D,invisible:!h&&!D,minHeight:"x40",onClick:N},D?f.createElement(l,{inheritColor:!0}):f.createElement(f.Fragment,null,H.icon&&f.createElement(c,{name:H.icon}),I(H.label))),R&&f.createElement(s,{color:"Disabled"===R.label?"warning":"hint",display:"flex",alignItems:"center"},f.createElement(c,{size:"x20",name:R.icon,mie:"x4"}),I(R.label)))};t.exportDefault(h(T))}

