function module(e,n,t){var i,r,o,s,a,c,l,u,m,f,d,p,h,k,x,E,v,b,g,C,T,R,_,P,w,I,S,L,y,G,z,M,N,V;function H(){var e=i(["white-space: nowrap"]);return H=function(){return e},e}t.link("@babel/runtime/helpers/taggedTemplateLiteralLoose",{default:function(e){i=e}},0),t.link("@babel/runtime/helpers/extends",{default:function(e){r=e}},1),t.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){o=e}},2),t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){s=e}},3),t.link("@babel/runtime/regenerator",{default:function(e){a=e}},4),t.link("react",{default:function(e){c=e},useState:function(e){l=e},useCallback:function(e){u=e},useEffect:function(e){m=e}},0),t.link("@rocket.chat/fuselage",{TextInput:function(e){f=e},Table:function(e){d=e},Margins:function(e){p=e},Box:function(e){h=e},Icon:function(e){k=e},CheckBox:function(e){x=e},Throbber:function(e){E=e},Tabs:function(e){v=e},Button:function(e){b=e}},1),t.link("@rocket.chat/fuselage-hooks",{useMutableCallback:function(e){g=e},useDebouncedValue:function(e){C=e}},2),t.link("@rocket.chat/css-in-js",{css:function(e){T=e}},3),t.link("../../../components/Page",{default:function(e){R=e}},4),t.link("./PermissionsContextBar",{default:function(e){_=e}},5),t.link("../../../components/GenericTable",{default:function(e){P=e}},6),t.link("../../../hooks/useReactiveValue",{useReactiveValue:function(e){w=e}},7),t.link("../../../contexts/TranslationContext",{useTranslation:function(e){I=e}},8),t.link("../../../contexts/ServerContext",{useMethod:function(e){S=e}},9),t.link("../../../contexts/ToastMessagesContext",{useToastMessageDispatch:function(e){L=e}},10),t.link("../../../contexts/RouterContext",{useRoute:function(e){y=e}},11),t.link("../../../../app/authorization/client/lib/ChatPermissions",{ChatPermissions:function(e){G=e}},12),t.link("../../../../app/authorization/lib",{CONSTANTS:function(e){z=e},AuthorizationUtils:function(e){M=e}},13),t.link("../../../../app/models/client",{Roles:function(e){N=e}},14),t.link("../../../contexts/AuthorizationContext",{usePermission:function(e){V=e}},15);var A=function(e){var n=e.onGrant,t=e.onRemove,i=e.permissionId,r=L();return g(function(){function e(e,o){return a.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:if(s.prev=0,!o){s.next=6;break}return s.next=4,a.awrap(t(i,e));case 4:s.next=8;break;case 6:return s.next=8,a.awrap(n(i,e));case 8:return s.abrupt("return",!o);case 11:s.prev=11,s.t0=s.catch(0),r({type:"error",message:s.t0});case 14:return s.abrupt("return",o);case 15:case"end":return s.stop()}}return s}(),null,null,[[0,11]],Promise)}return e}())},B=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"permissions",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:25,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=u((function(){var r=new RegExp(n,"i");return G.find({level:"permissions"===e?{$ne:z.SETTINGS_LEVEL}:z.SETTINGS_LEVEL,_id:r},{sort:{_id:1},skip:i,limit:t})}),[n,t,i,e]),o=g((function(){return N.find().fetch()}),[]),s=w(r),a=w(o);return[s.fetch(),s.count(!1),a]},D=c.memo((function(e){var n=e.grantedRoles,t=void 0===n?[]:n,i=e._id,r=e.description,o=e.onChange,u=e.lineHovered,m=e.permissionId,f=l((function(){return!!t.includes(i)})),k=s(f,2),v=k[0],b=k[1],C=l(!1),T=s(C,2),R=T[0],_=T[1],P=M.isPermissionRestrictedForRole(m,i),w=g(function(){function e(){var e;return a.async(function(){function n(n){for(;;)switch(n.prev=n.next){case 0:return _(!0),n.next=3,a.awrap(o(i,v));case 3:e=n.sent,b(e),_(!1);case 6:case"end":return n.stop()}}return n}(),null,null,null,Promise)}return e}()),I=!!R||!!P;return c.createElement(d.Cell,{withTruncatedText:!0},c.createElement(p,{inline:"x2"},c.createElement(x,{checked:v,onChange:w,disabled:I}),!R&&c.createElement(h,{display:"inline",color:"hint",invisible:!u},r||i),R&&c.createElement(E,{size:"x12",display:"inline-block"})))})),F=function(e,n){if(n.level===z.SETTINGS_LEVEL){var t="";return n.group&&(t=e(n.group)+" > "),n.section&&(t=""+t+e(n.section)+" > "),""+t+e(n.settingId)}return e(n._id)},W=c.memo((function(e){var n=e.permission,t=e.t,i=e.roleList,a=e.onGrant,u=e.onRemove,m=o(e,["permission","t","roleList","onGrant","onRemove"]),f=n._id,p=n.roles,h=l(!1),k=s(h,2),x=k[0],E=k[1],v=g((function(){return E(!0)})),b=g((function(){return E(!1)})),C=A({onGrant:a,onRemove:u,permissionId:f});return c.createElement(d.Row,r({key:f,role:"link",action:!0,tabIndex:0,onMouseEnter:v,onMouseLeave:b},m),c.createElement(d.Cell,{maxWidth:"x300",withTruncatedText:!0,title:t(f+"_description")},F(t,n)),i.map((function(e){var n=e._id,t=e.description;return(c.createElement(D,{key:n,_id:n,description:t,grantedRoles:p,onChange:C,lineHovered:x,permissionId:n}))})))})),j=c.memo((function(e){var n=e.router,t=e._id,i=e.description,s=o(e,["router","_id","description"]),a=g((function(){n.push({context:"edit",_id:t})}));return c.createElement(P.HeaderCell,r({clickable:!0,pi:"x4",p:"x8"},s),c.createElement(h,{className:T(H()),pb:"x8",pi:"x12",mi:"neg-x2",borderStyle:"solid",borderWidth:"x2",borderRadius:"x2",borderColor:"neutral-300",onClick:a},c.createElement(p,{inline:"x2"},c.createElement("span",null,i||t),c.createElement(k,{name:"edit",size:"x16"}))))})),q=function(e){var n=e.onChange,t=I(),i=l(""),r=s(i,2),o=r[0],a=r[1],u=C(o,500);m((function(){n(u)}),[u,n]);var d=g((function(e){var n=e.currentTarget.value;a(n)}));return(c.createElement(f,{value:o,onChange:d,placeholder:t("Search"),flexGrow:0}))},O=function(){var e=I(),n=l(""),t=s(n,2),i=t[0],r=t[1],o=V("access-permissions"),a=V("access-setting-permissions"),m,f=l(o?"permissions":"settings"),d=s(f,2),h=d[0],x=d[1],E=l({limit:25,skip:0}),C=s(E,2),T=C[0],w=C[1],L=y("admin-permissions"),G=S("authorization:addPermissionToRole"),z=S("authorization:removeRoleFromPermission"),M=B(h,i,T.limit,T.skip),N=s(M,3),H=N[0],A=N[1],D=N[2],F=g((function(e){var n=e.current,t=e.itemsPerPage;w({skip:n,limit:t})})),O=g((function(){"permissions"!==h&&x("permissions")})),U=g((function(){"settings"!==h&&x("settings")})),$=g((function(){L.push({context:"new"})}));return c.createElement(R,{flexDirection:"row"},c.createElement(R,null,c.createElement(R.Header,{title:e("Permissions")},c.createElement(b,{small:!0,square:!0,onClick:$},c.createElement(k,{name:"plus"}))),c.createElement(p,{blockEnd:"x8"},c.createElement(v,null,c.createElement(v.Item,{selected:"permissions"===h,onClick:O,disabled:!o},e("Permissions")),c.createElement(v.Item,{selected:"settings"===h,onClick:U,disabled:!a},e("Settings")))),c.createElement(R.Content,{mb:"neg-x8"},c.createElement(p,{block:"x8"},c.createElement(q,{onChange:r}),c.createElement(P,{header:c.createElement(c.Fragment,null,c.createElement(P.HeaderCell,{width:"x120"},e("Name")),D.map((function(e){var n=e._id,t=e.description;return(c.createElement(j,{key:n,_id:n,description:t,router:L}))}))),total:A,results:H,params:T,setParams:F,fixed:!1},u((function(n){return c.createElement(W,{key:n._id,permission:n,t:e,roleList:D,onGrant:G,onRemove:z})}),[G,z,D,e]))))),c.createElement(_,null))};t.exportDefault(O)}

