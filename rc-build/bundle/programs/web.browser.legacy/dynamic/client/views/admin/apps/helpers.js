function module(r,n,e){var t,a,i,s,o;e.export({appEnabledStatuses:function(){return u},apiCurlGetter:function(){return c},handleInstallError:function(){return p},handleAPIError:function(){return d},warnStatusChange:function(){return h},appButtonProps:function(){return A},appStatusSpanProps:function(){return _},formatPrice:function(){return E},formatPricingPlan:function(){return I}}),e.link("@rocket.chat/apps-engine/definition/AppStatus",{AppStatus:function(r){t=r}},0),e.link("semver",{default:function(r){a=r}},1),e.link("toastr",{default:function(r){i=r}},2),e.link("../../../../app/apps/lib/misc/Utilities",{Utilities:function(r){s=r}},3),e.link("../../../../app/utils/client",{t:function(r){o=r}},4);var u=[t.AUTO_ENABLED,t.MANUALLY_ENABLED],l=[t.COMPILER_ERROR_DISABLED,t.ERROR_DISABLED,t.INVALID_SETTINGS_DISABLED,t.INVALID_LICENSE_DISABLED],c=function(r){return function(n,e){var t=e.examples[n]||{};return s.curl({url:r(e.computedPath),method:n,params:t.params,query:t.query,content:t.content,headers:t.headers}).split("\n")}};function p(r){if(r.xhr&&r.xhr.responseJSON){var n=r.xhr.responseJSON,e=n.status,t=n.messages,a=n.error,s=n.payload,u=void 0===s?null:s,l;switch(e){case"storage_error":l=t.join("");break;case"app_user_error":l=t.join(""),u&&u.username&&(l=o("Apps_User_Already_Exists",{username:u.username}));break;default:l=a||"There has been an error installing the app"}i.error(l)}}var f=function(r){var n;return["Could not reach the Marketplace"].includes(r)},d=function(r){var n=r.xhr&&r.xhr.responseJSON&&r.xhr.responseJSON.error||r.message;f(n)?i.warning(n):i.error(n)},h=function(r,n){l.includes(n)?i.error(o("App_status_"+n),r):i.info(o("App_status_"+n),r)},A=function(r){var n=r.installed,e=r.version,t=r.marketplaceVersion,i=r.isPurchased,s=r.price,o=r.purchaseType,u=r.subscriptionInfo,l,c,p,f;return n&&e&&t&&a.lt(e,t)?{action:"update",icon:"reload",label:"Update"}:n?void 0:i?{action:"install",label:"Install"}:"subscription"!==o||u.status?s>0?{action:"purchase",label:"Buy"}:{action:"purchase",label:"Install"}:{action:"purchase",label:"Trial"}},_=function(r){var n=r.installed,e=r.status,a=r.subscriptionInfo,i,s,o;if(n)return l.includes(e)?{type:"failed",icon:"warning",label:e===t.INVALID_SETTINGS_DISABLED?"Config Needed":"Failed"}:u.includes(e)?a&&"trialing"===a.status?{icon:"checkmark-circled",label:"Trial period"}:{icon:"checkmark-circled",label:"Enabled"}:{type:"warning",icon:"warning",label:"Disabled"}},E=function(r){return"$"+Number.parseFloat(r).toFixed(2)},I=function(r){var n=r.strategy,e=r.price,t=r.tiers,a=void 0===t?[]:t,i,s=(Array.isArray(a)&&a.find((function(r){return r.price===e}))||{}).perUnit,u=void 0!==s&&s,l=["Apps_Marketplace_pricingPlan",Array.isArray(a)&&a.length>0&&"startingAt",n,u&&"perUser"].filter(Boolean).join("_");return o(l,{price:E(e)})}}

