function module(e,t,n){var r,a,o,c,l,s,i,u,d,m,f,k,v,p,C,h,x,g,y,T,E,w,b,D;function M(e){var t=e._id,n=e.reload,r=x("livechat:removeRoom"),a=w(),c=b(),i=h(),u=l(function(){function e(){return o.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.awrap(r(t));case 3:e.next=8;break;case 5:e.prev=5,e.t0=e.catch(0),console.log(e.t0);case 8:n();case 9:case"end":return e.stop()}}return e}(),null,null,[[0,5]],Promise)}return e}()),d=l((function(e){e.stopPropagation();var t=function(){function e(){return o.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,o.awrap(u());case 3:c({type:"success",message:i("Chat_removed")}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),c({type:"error",message:e.t0});case 9:a();case 10:case"end":return e.stop()}}return e}(),null,null,[[0,6]],Promise)}return e}();a(s.createElement(E,{onDelete:t,onCancel:function(){return a()}}))}));return s.createElement(m.Cell,{fontScale:"p1",color:"hint",withTruncatedText:!0},s.createElement(k,{small:!0,ghost:!0,title:i("Remove"),onClick:d},s.createElement(f,{name:"trash",size:"x16"})))}n.link("@babel/runtime/helpers/objectSpread2",{default:function(e){r=e}},0),n.link("@babel/runtime/helpers/slicedToArray",{default:function(e){a=e}},1),n.link("@babel/runtime/regenerator",{default:function(e){o=e}},2),n.export({RemoveChatButton:function(){return M}}),n.link("@rocket.chat/fuselage-hooks",{useDebouncedValue:function(e){c=e},useMutableCallback:function(e){l=e}},0),n.link("react",{default:function(e){s=e},useMemo:function(e){i=e},useCallback:function(e){u=e},useState:function(e){d=e}},1),n.link("@rocket.chat/fuselage",{Table:function(e){m=e},Icon:function(e){f=e},Button:function(e){k=e}},2),n.link("moment",{default:function(e){v=e}},3),n.link("meteor/kadira:flow-router",{FlowRouter:function(e){p=e}},4),n.link("../../../components/GenericTable",{default:function(e){C=e}},5),n.link("../../../contexts/TranslationContext",{useTranslation:function(e){h=e}},6),n.link("../../../contexts/ServerContext",{useMethod:function(e){x=e}},7),n.link("../../../contexts/AuthorizationContext",{usePermission:function(e){g=e}},8),n.link("../../../components/NotAuthorizedPage",{default:function(e){y=e}},9),n.link("./CurrentChatsPage",{default:function(e){T=e}},10),n.link("../../../components/DeleteWarningModal",{default:function(e){E=e}},11),n.link("../../../contexts/ModalContext",{useSetModal:function(e){w=e}},12),n.link("../../../contexts/ToastMessagesContext",{useToastMessageDispatch:function(e){b=e}},13),n.link("../../../hooks/useEndpointData",{useEndpointData:function(e){D=e}},14);var S=function(e){return"asc"===e?1:-1},H=function(e,t){var n=e.guest,o=e.servedBy,c=e.department,l=e.status,s=e.from,u=e.to,d=e.tags,m=e.customFields,f=e.itemsPerPage,k=e.current,p=a(t,2),C=p[0],h=p[1];return i((function(){var e,t=r(r(r({},n&&{roomName:n}),{},{sort:JSON.stringify((e={},e[C]=S(h),e.ts="ts"===C?S(h):void 0,e))},f&&{count:f}),k&&{offset:k});return(s||u)&&(t.createdAt=JSON.stringify(r(r({},s&&{start:v(new Date(s)).set({hour:"00",minutes:"00",seconds:"00"}).format("YYYY-MM-DDTHH:mm:ss")}),u&&{end:v(new Date(u)).set({hour:"23",minutes:"59",seconds:"59"}).format("YYYY-MM-DDTHH:mm:ss")}))),"all"!==l&&(t.open="opened"===l),o&&"all"!==o&&(t.agents=[o]),c&&"all"!==c&&(t.departmentId=c),d&&d.length>0&&(t.tags=d),m&&Object.keys(m).length>0&&(t.customFields=JSON.stringify(m)),t}),[n,C,h,f,k,s,u,l,o,c,d,m])};function P(){var e=h(),t=g("view-livechat-current-chats"),n=d({fname:"",servedBy:[],status:"",department:"",from:"",to:"",customFields:{},current:0,itemsPerPage:25}),r=a(n,2),o=r[0],f=r[1],k=d(["ts","desc"]),x=a(k,2),E=x[0],w=x[1],b=c(o,500),S=c(E,500),P=H(b,S),B=l((function(e){var t=a(E,2),n=t[0],r=t[1];w(n!==e?[e,"asc"]:[e,"asc"===r?"desc":"asc"])})),Y=l((function(e){p.go("live",{id:e})})),_=D("livechat/rooms",P),R=_.value,I=_.reload,N=i((function(){return[s.createElement(C.HeaderCell,{key:"name",direction:E[1],active:"name"===E[0],onClick:B,sort:"name"},e("Name")),s.createElement(C.HeaderCell,{key:"departmentId",direction:E[1],active:"departmentId"===E[0],onClick:B,sort:"departmentId"},e("Department")),s.createElement(C.HeaderCell,{key:"servedBy",direction:E[1],active:"servedBy"===E[0],onClick:B,sort:"servedBy"},e("Served_By")),s.createElement(C.HeaderCell,{key:"ts",direction:E[1],active:"ts"===E[0],onClick:B,sort:"ts"},e("Started_At")),s.createElement(C.HeaderCell,{key:"lm",direction:E[1],active:"lm"===E[0],onClick:B,sort:"lm"},e("Last_Message")),s.createElement(C.HeaderCell,{key:"status",direction:E[1],active:"status"===E[0],onClick:B,sort:"status",w:"x100"},e("Status")),s.createElement(C.HeaderCell,{key:"remove",w:"x60"},e("Remove"))].filter(Boolean)}),[E,B,e]),A=u((function(t){var n=t._id,r=t.fname,a=t.servedBy,o=t.ts,c=t.lm,l=t.department,i=t.open;return(s.createElement(m.Row,{key:n,tabIndex:0,role:"link",onClick:function(){return Y(n)},action:!0,"qa-user-id":n},s.createElement(m.Cell,{withTruncatedText:!0},r),s.createElement(m.Cell,{withTruncatedText:!0},l?l.name:""),s.createElement(m.Cell,{withTruncatedText:!0},a&&a.username),s.createElement(m.Cell,{withTruncatedText:!0},v(o).format("L LTS")),s.createElement(m.Cell,{withTruncatedText:!0},v(c).format("L LTS")),s.createElement(m.Cell,{withTruncatedText:!0},e(i?"Open":"Closed")),!i&&s.createElement(M,{_id:n,reload:I})))}),[Y,I,e]);return t?s.createElement(T,{setParams:f,params:o,onHeaderClick:B,data:R,useQuery:H,reload:I,header:N,renderRow:A,title:e("Current_Chats")}):s.createElement(y,null)}n.exportDefault(P)}

