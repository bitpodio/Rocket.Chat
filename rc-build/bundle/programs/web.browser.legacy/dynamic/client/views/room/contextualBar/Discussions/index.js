function module(e,n,t){var o,i,r,s,u,l,a,c,d,f,m,k,p,h,x,g,v,b,C,E,I,T,S,w,y,D,M,R,B,U,L,A,z;function G(e){return function(n){var t=n.msg,o=n.username,s=n.tcount,l=n.ts,a=r(n,["msg","username","tcount","ts"]);return(u.createElement(e,i({replies:s,username:o,msg:t,ts:l},a)))}}t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){o=e}},0),t.link("@babel/runtime/helpers/extends",{default:function(e){i=e}},1),t.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){r=e}},2),t.export({withData:function(){return H},normalizeThreadMessage:function(){return P},DiscussionList:function(){return W}}),t.link("meteor/kadira:flow-router",{FlowRouter:function(e){s=e}},0),t.link("react",{default:function(e){u=e},useCallback:function(e){l=e},useMemo:function(e){a=e},useState:function(e){c=e},memo:function(e){d=e}},1),t.link("@rocket.chat/fuselage",{Box:function(e){f=e},Icon:function(e){m=e},TextInput:function(e){k=e},Callout:function(e){p=e}},2),t.link("react-virtuoso",{Virtuoso:function(e){h=e}},3),t.link("@rocket.chat/fuselage-hooks",{useDebouncedValue:function(e){x=e},useResizeObserver:function(e){g=e},useAutoFocus:function(e){v=e}},4),t.link("../../../../components/VerticalBar",{default:function(e){b=e}},5),t.link("../../../../contexts/TranslationContext",{useTranslation:function(e){C=e}},6),t.link("../../../../contexts/UserContext",{useUserId:function(e){E=e},useUserSubscription:function(e){I=e}},7),t.link("../../../../hooks/useTimeAgo",{useTimeAgo:function(e){T=e}},8),t.link("../../hooks/useUserRoom",{useUserRoom:function(e){S=e}},9),t.link("../../../../contexts/SettingsContext",{useSetting:function(e){w=e}},10),t.link("./components/Message",{default:function(e){y=e}},11),t.link("../../../../lib/clickableItem",{clickableItem:function(e){D=e}},12),t.link("../../../../../lib/escapeHTML",{escapeHTML:function(e){M=e}},13),t.link("../../../../hooks/useAsyncState",{AsyncStatePhase:function(e){R=e}},14),t.link("../../providers/ToolboxProvider",{useTabBarClose:function(e){B=e}},15),t.link("../../../../lib/renderMessageBody",{renderMessageBody:function(e){U=e}},16),t.link("../../../../components/ScrollableContentWrapper",{default:function(e){L=e}},17),t.link("./useDiscussionsList",{useDiscussionsList:function(e){A=e}},18),t.link("../../../../hooks/lists/useRecordList",{useRecordList:function(e){z=e}},19);var _=u.memo(G(D(y))),N={tunread:1,tunreadUser:1,tunreadGroup:1},F={t:1,name:1};function H(e){return function(n){var t=n.rid,s=r(n,["rid"]),d=S(t,F),f=I(t,N),m=E(),k=B(),p=c(""),h=o(p,2),g=h[0],v=h[1],b=x(g,400),C=a((function(){return{rid:t,text:b}}),[t,b]),T=A(C,m),w=T.discussionsList,y=T.initialItemCount,D=T.loadMoreItems,M=z(w),U=M.phase,L=M.error,G=M.items,_=M.itemCount,H=l((function(e){v(e.currentTarget.value)}),[]);return u.createElement(e,i({},s,{onClose:k,unread:null==f?void 0:f.tunread,unreadUser:null==f?void 0:f.tunreadUser,unreadGroup:null==f?void 0:f.tunreadGroup,userId:m,error:L,discussions:G,total:_,initial:y,loading:U===R.LOADING,loadMoreItems:D,room:d,text:g,setText:H}))}}var P=function(e){var n=i({},e);if(n.msg)return U(n).replace(/<br\s?\\?>/g," ");if(n.attachments){var t=n.attachments.find((function(e){return e.title||e.description}));if(t&&t.description)return M(t.description);if(t&&t.title)return M(t.title)}},V=d(function(){function e(e){var n=e.discussion,t=e.showRealNames,o=e.userId,i=e.onClick,r=C(),s=T(),l=P(n),a=n.u.name,c=void 0===a?n.u.username:a;return u.createElement(_,{replies:n.replies,dcount:n.dcount,dlm:n.dlm,name:t?c:n.u.username,username:n.u.username,following:n.replies&&n.replies.includes(o),"data-drid":n.drid,msg:l,t:r,formatDate:s,onClick:i})}return e}());function W(e){var n=e.total,t=void 0===n?10:n,o=e.discussions,i=void 0===o?[]:o,r=e.loadMoreItems,a=e.loading,c=e.onClose,d=e.error,x=e.userId,E=e.text,I=e.setText,T=w("UI_Use_Real_Name"),S=C(),y=v(!0),D=l((function(e){var n=e.currentTarget.dataset.drid;s.goToRoomById(n)}),[]),M=g({debounceDelay:200}),R=M.ref,B=M.contentBoxSize,U=(B=void 0===B?{}:B).inlineSize,A=void 0===U?378:U,z=B.blockSize,G=void 0===z?1:z;return u.createElement(u.Fragment,null,u.createElement(b.Header,null,u.createElement(b.Icon,{name:"discussion"}),u.createElement(f,{flexShrink:1,flexGrow:1,withTruncatedText:!0,mi:"x8"},S("Discussions")),u.createElement(b.Close,{onClick:c})),u.createElement(b.Content,{paddingInline:0,ref:R},u.createElement(f,{display:"flex",flexDirection:"row",p:"x24",borderBlockEndWidth:"x2",borderBlockEndStyle:"solid",borderBlockEndColor:"neutral-200",flexShrink:0},u.createElement(k,{placeholder:S("Search_Messages"),value:E,onChange:I,ref:y,addon:u.createElement(m,{name:"magnifier",size:"x20"})})),u.createElement(f,{flexGrow:1,flexShrink:1,overflow:"hidden",display:"flex"},d&&u.createElement(p,{mi:"x24",type:"danger"},d.toString()),0===t&&u.createElement(f,{p:"x24"},S("No_Discussions_found")),!d&&t>0&&i.length>0&&u.createElement(u.Fragment,null,u.createElement(h,{style:{height:G,width:A,overflow:"hidden"},totalCount:t,endReached:a?function(){}:function(e){return r(e,Math.min(50,t-e))},overscan:25,data:i,components:{Scroller:L},itemContent:function(e,n){return u.createElement(V,{discussion:n,showRealNames:T,userId:x,onClick:D})}})))))}t.exportDefault(H(W))}

