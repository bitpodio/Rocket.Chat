function module(n,e,t){var i,o,u,r,a,c,l,s,f,m,d,_,E,C,k,x,p,T,h,w,J,R,S,v,b,g;t.link("@babel/runtime/regenerator",{default:function(n){i=n}},0),t.link("@babel/runtime/helpers/slicedToArray",{default:function(n){o=n}},1),t.export({CallJitsi:function(){return U}}),t.link("react",{default:function(n){u=n},useRef:function(n){r=n},useEffect:function(n){a=n},useState:function(n){c=n},useMemo:function(n){l=n},useLayoutEffect:function(n){s=n}},0),t.link("@rocket.chat/fuselage",{Box:function(n){f=n},Skeleton:function(n){m=n}},1),t.link("@rocket.chat/fuselage-hooks",{useMutableCallback:function(n){d=n},useSafely:function(n){_=n}},2),t.link("./components/CallModal",{CallModal:function(n){E=n}},3),t.link("../../../../../contexts/ModalContext",{useSetModal:function(n){C=n}},4),t.link("../../../../../contexts/UserContext",{useUserRoom:function(n){k=n},useUser:function(n){x=n}},5),t.link("../../../../../contexts/TranslationContext",{useTranslation:function(n){p=n}},6),t.link("../../../../../contexts/SettingsContext",{useSettings:function(n){T=n}},7),t.link("../../../../../components/VerticalBar",{default:function(n){h=n}},8),t.link("../../../../../../app/videobridge/constants",{HEARTBEAT:function(n){w=n},TIMEOUT:function(n){J=n},DEBOUNCE:function(n){R=n}},9),t.link("../../../../../contexts/ServerContext",{useMethod:function(n){S=n}},10),t.link("../../../../../contexts/ConnectionStatusContext",{useConnectionStatus:function(n){v=n}},11),t.link("./lib/JitsiBridge",{JitsiBridge:function(n){b=n}},12),t.link("../../../providers/ToolboxProvider",{useTabBarClose:function(n){g=n}},13);var U=function(n){var e=n.handleClose,t=n.openNewWindow,i=n.refContent,o=n.children,r=p(),a=t?u.createElement(u.Fragment,null,u.createElement(f,{fontScale:"p2"},r("Video_Conference")),u.createElement(f,{fontScale:"p1",color:"neutral-700"},r("Opened_in_a_new_window"))):u.createElement("div",{ref:i});return u.createElement(u.Fragment,null,u.createElement(h.Header,null,u.createElement(h.Icon,{name:"phone"}),u.createElement(h.Text,null,r("Call")),e&&u.createElement(h.Close,{onClick:e})),u.createElement(h.ScrollableContent,null,a,o))},A={_id:["Jitsi_Open_New_Window","Jitsi_Domain","Jitsi_URL_Room_Hash","uniqueID","Jitsi_URL_Room_Prefix","Jitsi_URL_Room_Suffix","Jitsi_Chrome_Extension","Jitsi_SSL","Jitsi_Enabled_TokenAuth"]},D=function(n){var e=n.rid,t=x(),f,p=v().connected,h=_(c()),D=o(h,2),B=D[0],L=D[1],M=c(!1),j=o(M,2),N=j[0],H=j[1],I=k(e),O=C(),W=g(),y=d((function(){return O(null)})),P=S("jitsi:generateAccessToken"),q=S("jitsi:updateTimeout"),F=d((function(){y(),W()})),V=r(),Y=Object.fromEntries(T(A).map((function(n){var e,t;return[n._id,n.value]}))),z=Y.Jitsi_Open_New_Window,G=Y.Jitsi_Domain,K=Y.Jitsi_SSL,Q=Y.Jitsi_Chrome_Extension,X=Y.Jitsi_URL_Room_Hash,Z=Y.uniqueID,$=Y.Jitsi_URL_Room_Prefix,nn=Y.Jitsi_URL_Room_Suffix,en=Y.Jitsi_Enabled_TokenAuth;a((function(){var n=!1;if(en)return function(){function t(){var t;return i.async(function(){function o(o){for(;;)switch(o.prev=o.next){case 0:return o.next=2,i.awrap(P(e));case 2:t=o.sent,!n&&L(t);case 4:case"end":return o.stop()}}return o}(),null,null,null,Promise)}return t}()(),function(){n=!0};L()}),[P,en,e,L]),s((function(){p||W()}),[p,W]);var tn=X?Z+e:encodeURIComponent("d"===I.t?I.usernames.join(" x "):I.name),on=l((function(){var n;if(!en||B)return new b({openNewWindow:z,ssl:K,domain:G,jitsiRoomName:$+tn+nn,accessToken:B,desktopSharingChromeExtId:Q,name:t.name||t.username},w)}),[B,Q,G,en,z,$,tn,K,nn,t.name,t.username]),un=d((function(){return new Date-new Date(I.jitsiTimeout)>J?on.dispose():new Date-new Date(I.jitsiTimeout)+J>R?q(e):void 0}));a((function(){if(N&&on)return on.start(V.current),q(e),on.on("HEARTBEAT",un),function(){on.off("HEARTBEAT",un),on.dispose()}}),[N,on,e,un,q]);var rn=d((function(){H(!0),z&&W()}));return s((function(){N?y():O((function(){return u.createElement(E,{handleYes:rn,handleCancel:F})}))}),[N,y,F,rn,O]),u.createElement(U,{handleClose:W,openNewWindow:z,refContent:V},!N&&u.createElement(m,null))};t.exportDefault(u.memo(D))}

