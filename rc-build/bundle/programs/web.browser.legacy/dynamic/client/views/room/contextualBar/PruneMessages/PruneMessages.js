function module(e,n,t){var r,a,l,i,o,s,c,u,d,m,f,h,p,E,T,g,x,k,_,D,v,w,b,C,P,y,L,M;t.link("@babel/runtime/regenerator",{default:function(e){r=e}},0),t.link("@babel/runtime/helpers/toConsumableArray",{default:function(e){a=e}},1),t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){l=e}},2),t.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){i=e}},3),t.export({DialogPruneMessages:function(){return F},DateTimeRow:function(){return O},PruneMessages:function(){return R}}),t.link("react",{default:function(e){o=e},useCallback:function(e){s=e},useEffect:function(e){c=e},useState:function(e){u=e}},0),t.link("@rocket.chat/fuselage",{Field:function(e){d=e},ButtonGroup:function(e){m=e},Button:function(e){f=e},CheckBox:function(e){h=e},InputBox:function(e){p=e},Box:function(e){E=e},Margins:function(e){T=e},Callout:function(e){g=e}},1),t.link("@rocket.chat/fuselage-hooks",{useMutableCallback:function(e){x=e},useUniqueId:function(e){k=e}},2),t.link("moment",{default:function(e){_=e}},3),t.link("../../../../../ee/client/audit/UserAutoCompleteMultiple",{default:function(e){D=e}},4),t.link("../../../../contexts/TranslationContext",{useTranslation:function(e){v=e}},5),t.link("../../../../components/VerticalBar",{default:function(e){w=e}},6),t.link("../../../../contexts/UserContext",{useUserRoom:function(e){b=e}},7),t.link("../../../../contexts/ToastMessagesContext",{useToastMessageDispatch:function(e){C=e}},8),t.link("../../../../contexts/ModalContext",{useSetModal:function(e){P=e}},9),t.link("../../../../hooks/useForm",{useForm:function(e){y=e}},10),t.link("../../../../contexts/ServerContext",{useMethod:function(e){L=e}},11),t.link("../../../../components/DeleteWarningModal",{default:function(e){M=e}},12);var N=function(){var e=(new Date).getTimezoneOffset(),n=Math.abs(e);return(e<0?"+":"-")+("00"+Math.floor(n/60)).slice(-2)+":"+("00"+n%60).slice(-2)},F=function(e){var n=e.children,t=i(e,["children"]);return(o.createElement(M,t,o.createElement(E,{textAlign:"center",fontScale:"s1"},n)))},O=function(e){var n=e.label,t=e.dateTime,r=e.handleDateTime;return(o.createElement(d,null,o.createElement(d.Label,{flexGrow:0},n),o.createElement(E,{display:"flex",mi:"neg-x4"},o.createElement(T,{inline:"x4"},o.createElement(p,{type:"date",value:null==t?void 0:t.date,onChange:null==r?void 0:r.date,flexGrow:1,h:"x20"}),o.createElement(p,{type:"time",value:null==t?void 0:t.time,onChange:null==r?void 0:r.time,flexGrow:1,h:"x20"})))))},R=function(e){var n=e.callOutText,t=e.validateText,r=e.newerDateTime,a=e.handleNewerDateTime,l=e.olderDateTime,i=e.handleOlderDateTime,s=e.users,c=e.inclusive,u=e.pinned,p=e.discussion,E=e.threads,T=e.attached,x=e.handleInclusive,_=e.handlePinned,b=e.handleDiscussion,C=e.handleThreads,P=e.handleAttached,y=e.onClickClose,L=e.onClickPrune,M=e.onChangeUsers,N=v(),F=k(),R=k(),I=k(),U=k(),A=k();return o.createElement(o.Fragment,null,o.createElement(w.Header,null,o.createElement(w.Icon,{name:"eraser"}),o.createElement(w.Text,null,N("Prune_Messages")),y&&o.createElement(w.Close,{onClick:y})),o.createElement(w.ScrollableContent,null,o.createElement(O,{label:N("Newer_than"),dateTime:r,handleDateTime:a}),o.createElement(O,{label:N("Older_than"),dateTime:l,handleDateTime:i}),o.createElement(d,null,o.createElement(d.Label,{flexGrow:0},N("Only_from_users")),o.createElement(D,{value:s,onChange:M,placeholder:N("Please_enter_usernames")})),o.createElement(d,null,o.createElement(d.Row,null,o.createElement(h,{id:F,checked:c,onChange:x}),o.createElement(d.Label,{htmlFor:F},N("Inclusive")))),o.createElement(d,null,o.createElement(d.Row,null,o.createElement(h,{id:R,checked:u,onChange:_}),o.createElement(d.Label,{htmlFor:R},N("RetentionPolicy_DoNotPrunePinned")))),o.createElement(d,null,o.createElement(d.Row,null,o.createElement(h,{id:I,checked:p,onChange:b}),o.createElement(d.Label,{htmlFor:I},N("RetentionPolicy_DoNotPruneDiscussion")))),o.createElement(d,null,o.createElement(d.Row,null,o.createElement(h,{id:U,checked:E,onChange:C}),o.createElement(d.Label,{htmlFor:U},N("RetentionPolicy_DoNotPruneThreads")))),o.createElement(d,null,o.createElement(d.Row,null,o.createElement(h,{id:A,checked:T,onChange:P}),o.createElement(d.Label,{htmlFor:A},N("Files_only")))),n&&!t&&o.createElement(g,{type:"warning"},n),t&&o.createElement(g,{type:"warning"},t)),o.createElement(w.Footer,null,o.createElement(m,{stretch:!0},o.createElement(f,{primary:!0,danger:!0,disabled:t&&!0,onClick:L},N("Prune")))))},I={newerDate:"",newerTime:"",olderDate:"",olderTime:"",users:[],inclusive:!1,pinned:!1,discussion:!1,threads:!1,attached:!1};t.exportDefault((function(e){var n=e.rid,t=e.tabBar,i=v(),d=b(n);d.type=d.t,d.rid=n;var m=d.name,f=P(),h=x((function(){return t&&t.close()})),p=s((function(){return f(null)}),[f]),E=C(),T=L("cleanRoomHistory"),g=u(new Date("0001-01-01T00:00:00Z")),k=l(g,2),D=k[0],w=k[1],M=u(new Date("9999-12-31T23:59:59Z")),O=l(M,2),U=O[0],A=O[1],B=u(),W=l(B,2),G=W[0],S=W[1],j=u(),H=l(j,2),Z=H[0],q=H[1],z=u(0),V=l(z,2),Y=V[0],J=V[1],K=y(I),Q=K.values,X=K.handlers,$=K.reset,ee=Q.newerDate,ne=Q.newerTime,te=Q.olderDate,re=Q.olderTime,ae=Q.users,le=Q.inclusive,ie=Q.pinned,oe=Q.discussion,se=Q.threads,ce=Q.attached,ue=X.handleNewerDate,de=X.handleNewerTime,me=X.handleOlderDate,fe=X.handleOlderTime,he=X.handleUsers,pe=X.handleInclusive,Ee=X.handlePinned,Te=X.handleDiscussion,ge=X.handleThreads,xe=X.handleAttached,ke=x((function(e,n){if(!n){if(ae.includes(e))return;return he([].concat(a(ae),[e]))}he(ae.filter((function(n){return n!==e})))})),_e=x(function(){function e(){var e,t;return r.async(function(){function a(a){for(;;)switch(a.prev=a.next){case 0:if(e=2e3,a.prev=1,Y!==e){a.next=4;break}return a.abrupt("return");case 4:return a.next=6,r.awrap(T({roomId:n,latest:U,oldest:D,inclusive:le,limit:e,excludePinned:ie,ignoreDiscussion:oe,filesOnly:ce,fromUsers:ae,ignoreThreads:se}));case 6:if(t=a.sent,J(t),!(t<1)){a.next=10;break}throw new Error(i("No_messages_found_to_prune"));case 10:E({type:"success",message:t+" "+i("messages_pruned")}),p(),$(),a.next=19;break;case 15:a.prev=15,a.t0=a.catch(1),E({type:"error",message:a.t0}),p();case 19:case"end":return a.stop()}}return a}(),null,null,[[1,15]],Promise)}return e}()),De=function(){f(o.createElement(F,{onCancel:p,onDelete:_e,deleteText:i("Yes_prune_them")},i("Prune_Modal")))};return c((function(){ee&&w(new Date(ee+"T"+(ne||"00:00")+":00"+N())),te&&A(new Date(te+"T"+(re||"24:00")+":00"+N()))}),[ee,ne,te,re]),c((function(){var e=ie?" "+i("except_pinned",{}):"",n=ae.length?" "+i("if_they_are_from",{postProcess:"sprintf",sprintf:[ae.map((function(e){return e})).join(", ")]}):"",t=i(ce?"files":"messages",{});return S(ee&&te?i("Prune_Warning_between",{postProcess:"sprintf",sprintf:[t,m,_(D).format("L LT"),_(U).format("L LT")]})+e+n:ee?i("Prune_Warning_after",{postProcess:"sprintf",sprintf:[t,m,_(D).format("L LT")]})+e+n:te?i("Prune_Warning_before",{postProcess:"sprintf",sprintf:[t,m,_(U).format("L LT")]})+e+n:i("Prune_Warning_all",{postProcess:"sprintf",sprintf:[t,m]})+e+n),D>U?q(i("Newer_than_may_not_exceed_Older_than",{postProcess:"sprintf",sprintf:[]})):isNaN(D.getTime())||isNaN(U.getTime())?q(i("error-invalid-date",{postProcess:"sprintf",sprintf:[]})):void q()}),[ee,te,D,U,ce,m,i,ie,ae]),o.createElement(R,{callOutText:G,validateText:Z,newerDateTime:{date:ee,time:ne},handleNewerDateTime:{date:ue,time:de},olderDateTime:{date:te,time:re},handleOlderDateTime:{date:me,time:fe},users:ae,inclusive:le,pinned:ie,discussion:oe,threads:se,attached:ce,handleInclusive:pe,handlePinned:Ee,handleDiscussion:Te,handleThreads:ge,handleAttached:xe,onClickClose:h,onClickPrune:De,onChangeUsers:ke})}))}

