function module(e,t,n){var l,a,r,o,s,c,u,i,m,f,d,p,E,h,g,_,b,k,x,C,v,T,y,M,w,F,L,S,R;function j(){var e=o(["\n\tcursor: pointer;\n"]);return j=function(){return e},e}n.link("@babel/runtime/helpers/slicedToArray",{default:function(e){l=e}},0),n.link("@babel/runtime/regenerator",{default:function(e){a=e}},1),n.link("@babel/runtime/helpers/objectSpread2",{default:function(e){r=e}},2),n.link("@babel/runtime/helpers/taggedTemplateLiteralLoose",{default:function(e){o=e}},3),n.export({ExportMessages:function(){return B}}),n.link("react",{default:function(e){s=e},useState:function(e){c=e},useEffect:function(e){u=e},useMemo:function(e){i=e}},0),n.link("@rocket.chat/fuselage",{Field:function(e){m=e},TextInput:function(e){f=e},Select:function(e){d=e},ButtonGroup:function(e){p=e},Button:function(e){E=e},Box:function(e){h=e},Icon:function(e){g=e},Callout:function(e){_=e},FieldGroup:function(e){b=e}},1),n.link("@rocket.chat/css-in-js",{css:function(e){k=e}},2),n.link("@rocket.chat/fuselage-hooks",{useMutableCallback:function(e){x=e}},3),n.link("../../../../components/VerticalBar",{default:function(e){C=e}},4),n.link("../../../../components/AutoComplete",{UserAutoComplete:function(e){v=e}},5),n.link("../../../../contexts/TranslationContext",{useTranslation:function(e){T=e}},6),n.link("../../../../hooks/useForm",{useForm:function(e){y=e}},7),n.link("../../hooks/useUserRoom",{useUserRoom:function(e){M=e}},8),n.link("../../../../contexts/ServerContext",{useEndpoint:function(e){w=e}},9),n.link("../../../../../app/utils/client",{roomTypes:function(e){F=e},isEmail:function(e){L=e}},10),n.link("../../../../contexts/ToastMessagesContext",{useToastMessageDispatch:function(e){S=e}},11),n.link("../../providers/ToolboxProvider",{useTabBarClose:function(e){R=e}},12);var D=k(j()),U=function(e){var t=e.onCancel,n=e.rid,l=T(),o=y({dateFrom:"",dateTo:"",format:"html"}),c=o.values,u=o.handlers,h=c.dateFrom,g=c.dateTo,_=c.format,k=u.handleDateFrom,x=u.handleDateTo,C=u.handleFormat,v=i((function(){return[["html",l("HTML")],["json",l("JSON")]]}),[l]),M=w("POST","rooms.export"),F=S(),L=function(){function e(){return a.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.awrap(M(r(r(r({rid:n,type:"file"},h&&{dateFrom:new Date(h)}),g&&{dateTo:new Date(g)}),{},{format:_})));case 3:F({type:"success",message:l("Your_email_has_been_queued_for_sending")}),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),F({type:"error",message:e.t0});case 9:case"end":return e.stop()}}return e}(),null,null,[[0,6]],Promise)}return e}();return s.createElement(b,null,s.createElement(m,null,s.createElement(m.Label,null,l("Date_From")),s.createElement(m.Row,null,s.createElement(f,{type:"date",value:h,onChange:k}))),s.createElement(m,null,s.createElement(m.Label,null,l("Date_to")),s.createElement(m.Row,null,s.createElement(f,{type:"date",value:g,onChange:x}))),s.createElement(m,null,s.createElement(m.Label,null,l("Output_format")),s.createElement(m.Row,null,s.createElement(d,{value:_,onChange:C,placeholder:l("Format"),options:v}))),s.createElement(p,{stretch:!0,mb:"x12"},s.createElement(E,{onClick:t},l("Cancel")),s.createElement(E,{primary:!0,onClick:function(){return L()}},l("Export"))))},P=function(e){var t=e.onCancel,n=e.rid,r=T(),o=M(n),i=o&&o.t&&F.getRoomName(o.t,o),d=c([]),k=l(d,2),C=k[0],R=k[1],j=c(),U=l(j,2),P=U[0],B=U[1],A=y({dateFrom:"",dateTo:"",toUsers:"",additionalEmails:"",subject:r("Mail_Messages_Subject",i)}),N=A.values,O=A.handlers,I=S(),q=N.toUsers,z=N.additionalEmails,G=N.subject,H=x((function(){R([]),$(".messages-box .message",$("#chat-window-"+n)).removeClass("selected")}));u((function(){var e=$("#chat-window-"+n);$(".messages-box",e).addClass("selectable");var t=function(){var e=this.id;this.classList.contains("selected")?(this.classList.remove("selected"),R((function(t){return t.filter((function(t){return t!==e}))}))):(this.classList.add("selected"),R((function(t){return t.concat(e)})))};return $(".messages-box .message",e).on("click",t),function(){$(".messages-box",e).removeClass("selectable"),$(".messages-box .message",e).off("click",t).filter(".selected").removeClass("selected")}}),[n]);var Y=O.handleToUsers,J=O.handleAdditionalEmails,V=O.handleSubject,K=w("POST","rooms.export"),Q=function(){function e(){return a.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:if(0!==q.length||""!==z){e.next=3;break}return B(r("Mail_Message_Missing_to")),e.abrupt("return");case 3:if(""===z||L(z)){e.next=6;break}return B(r("Mail_Message_Invalid_emails",z)),e.abrupt("return");case 6:if(0!==C.length){e.next=9;break}return B(r("Mail_Message_No_messages_selected_select_all")),e.abrupt("return");case 9:return B(null),e.prev=10,e.next=13,a.awrap(K({rid:n,type:"email",toUsers:[q],toEmails:z.split(","),subject:G,messages:C}));case 13:I({type:"success",message:r("Your_email_has_been_queued_for_sending")}),e.next=19;break;case 16:e.prev=16,e.t0=e.catch(10),I({type:"error",message:e.t0});case 19:case"end":return e.stop()}}return e}(),null,null,[[10,16]],Promise)}return e}();return s.createElement(b,null,s.createElement(m,null,s.createElement(_,{onClick:H,title:r("Messages selected"),type:C.length>0?"success":"info"},s.createElement("p",null,C.length+" Messages selected"),C.length>0&&s.createElement(h,{is:"p",className:D},r("Click here to clear the selection")),0===C.length&&s.createElement(h,{is:"p"},r("Click_the_messages_you_would_like_to_send_by_email")))),s.createElement(m,null,s.createElement(m.Label,null,r("To_users")),s.createElement(m.Row,null,s.createElement(v,{value:q,onChange:Y}))),s.createElement(m,null,s.createElement(m.Label,null,r("To_additional_emails")),s.createElement(m.Row,null,s.createElement(f,{placeholder:r("Email_Placeholder_any"),value:z,onChange:J,addon:s.createElement(g,{name:"mail",size:"x20"})}))),s.createElement(m,null,s.createElement(m.Label,null,r("Subject")),s.createElement(m.Row,null,s.createElement(f,{value:G,onChange:V,addon:s.createElement(g,{name:"edit",size:"x20"})}))),P&&s.createElement(_,{type:"danger",title:P}),s.createElement(p,{stretch:!0,mb:"x12"},s.createElement(E,{onClick:t},r("Cancel")),s.createElement(E,{primary:!0,onClick:function(){return Q()}},r("Send"))))},B=function(){function e(e){var t=e.rid,n=T(),a=R(),r=c("email"),o=l(r,2),u=o[0],f=o[1],p=i((function(){return[["email",n("Send_via_email")],["file",n("Export_as_file")]]}),[n]);return s.createElement(s.Fragment,null,s.createElement(C.Header,null,n("Export_Messages"),s.createElement(C.Close,{onClick:a})),s.createElement(C.ScrollableContent,null,s.createElement(b,null,s.createElement(m,null,s.createElement(m.Label,null,n("Method")),s.createElement(m.Row,null,s.createElement(d,{value:u,onChange:function(e){return f(e)},placeholder:n("Type"),options:p})))),u&&"file"===u&&s.createElement(U,{rid:t,onCancel:a}),u&&"email"===u&&s.createElement(P,{rid:t,onCancel:a})))}return e}();n.exportDefault(B)}

