function module(e,n,t){var l,o,a,r,i,c,u,s,d,m,f,E,h,p,y,x,R,w,b,C,v,g,_,k,A,P,M,S,O,G,T,D,j,N,L,I,F,B,H,W,q,J;t.link("@babel/runtime/regenerator",{default:function(e){l=e}},0),t.link("@babel/runtime/helpers/objectWithoutProperties",{default:function(e){o=e}},1),t.link("@babel/runtime/helpers/slicedToArray",{default:function(e){a=e}},2),t.link("@babel/runtime/helpers/objectSpread2",{default:function(e){r=e}},3),t.link("react",{default:function(e){i=e},useCallback:function(e){c=e},useMemo:function(e){u=e},useRef:function(e){s=e}},0),t.link("@rocket.chat/fuselage",{Field:function(e){d=e},TextInput:function(e){m=e},PasswordInput:function(e){f=e},ToggleSwitch:function(e){E=e},MultiSelect:function(e){h=e},Accordion:function(e){p=e},Callout:function(e){y=e},NumberInput:function(e){x=e},FieldGroup:function(e){R=e},Button:function(e){w=e},ButtonGroup:function(e){b=e},Box:function(e){C=e},Icon:function(e){v=e},TextAreaInput:function(e){g=e}},1),t.link("@rocket.chat/fuselage-hooks",{useMutableCallback:function(e){_=e}},2),t.link("../../../../../components/VerticalBar",{default:function(e){k=e}},3),t.link("../../../../../components/RawText",{default:function(e){A=e}},4),t.link("../../../../../components/avatar/RoomAvatarEditor",{default:function(e){P=e}},5),t.link("../../../../../components/DeleteChannelWarning",{default:function(e){M=e}},6),t.link("../../../../../contexts/TranslationContext",{useTranslation:function(e){S=e}},7),t.link("../../../../../hooks/useForm",{useForm:function(e){O=e}},8),t.link("../../../../../../app/utils/client",{roomTypes:function(e){G=e},RoomSettingsEnum:function(e){T=e}},9),t.link("../../../../../../app/lib/lib/MessageTypes",{MessageTypesValues:function(e){D=e}},10),t.link("../../../../../contexts/ServerContext",{useMethod:function(e){j=e}},11),t.link("../../../../../contexts/ModalContext",{useSetModal:function(e){N=e}},12),t.link("../../../../../contexts/SettingsContext",{useSetting:function(e){L=e}},13),t.link("../../../../../contexts/AuthorizationContext",{usePermission:function(e){I=e},useAtLeastOnePermission:function(e){F=e},useRole:function(e){B=e}},14),t.link("../../../../../hooks/useEndpointAction",{useEndpointActionExperimental:function(e){H=e}},15),t.link("../../../hooks/useUserRoom",{useUserRoom:function(e){W=e}},16),t.link("../../../providers/ToolboxProvider",{useTabBarClose:function(e){q=e}},17),t.link("../../../../../../app/e2e/client/rocketchat.e2e",{e2e:function(e){J=e}},18);var U={c:"Channels",p:"Groups",d:"DMs"},V=function(e,n){var t=e.t,l=e.ro,o=e.archived,a=e.topic,i=e.description,c=e.announcement,s=e.joinCodeRequired,d=e.sysMes,m=e.encrypted,f=e.retention,E=void 0===f?{}:f,h=n.retentionPolicyEnabled,p=n.maxAgeDefault,y=L("RetentionPolicy_AppliesTo"+U[e.t]),x=L("RetentionPolicy_DoNotPrunePinned"),R=L("RetentionPolicy_FilesOnly");return u((function(){var n,u,f;return r({roomName:"d"===t?e.usernames.join(" x "):G.getRoomName(t,r({type:t},e)),roomType:t,readOnly:!!l,reactWhenReadOnly:!1,archived:!!o,roomTopic:null!=a?a:"",roomDescription:null!=i?i:"",roomAnnouncement:null!=c?c:"",roomAvatar:void 0,joinCode:"",joinCodeRequired:!!s,systemMessages:Array.isArray(d)?d:[],hideSysMes:!(null==d||!d.length),encrypted:m},h&&{retentionEnabled:null!==(n=E.enabled)&&void 0!==n?n:y,retentionOverrideGlobal:!!E.overrideGlobal,retentionMaxAge:Math.min(E.maxAge,p)||p,retentionExcludePinned:null!==(u=E.excludePinned)&&void 0!==u?u:x,retentionFilesOnly:null!==(f=E.filesOnly)&&void 0!==f?f:R})}),[c,o,i,x,R,s,p,E.enabled,E.excludePinned,E.filesOnly,E.maxAge,E.overrideGlobal,y,h,l,e,d,t,a,m])};function z(e){var n=e.rid,t=e.onClickBack,l=W(n),o=q();return i.createElement(K,{onClickClose:o,onClickBack:t,room:r({type:null==l?void 0:l.t},l)})}var Y=function(e,n,t,l){return(!e.default||l)&&("p"===e.t&&n||"c"===e.t&&t)};function K(e){var n=e.room,t=e.onClickClose,W=e.onClickBack,q=S(),z=N(),K=L("RetentionPolicy_Enabled"),Q=L("RetentionPolicy_MaxAge_"+U[n.t])||30,X=s({}),Z=c((function(e){var n=e.initialValue,t=e.value,l=e.key,o=X.current;JSON.stringify(n)!==JSON.stringify(t)?("systemMessages"===l&&(null==t?void 0:t.length)>0&&(o.hideSysMes=!0),o[l]=t):delete o[l]}),[]),$=O(V(n,{retentionPolicyEnabled:K,maxAgeDefault:Q}),Z),ee=$.values,ne=$.handlers,te=$.hasUnsavedChanges,le=$.reset,oe=$.commit,ae=u((function(){return D.map((function(e){var n=e.key,t=e.i18nLabel;return[n,q(t)]}))}),[q]),re=ee.roomName,ie=ee.roomType,ce=ee.readOnly,ue=ee.encrypted,se=ee.roomAvatar,de=ee.archived,me=ee.roomTopic,fe=ee.roomDescription,Ee=ee.roomAnnouncement,he=ee.reactWhenReadOnly,pe=ee.joinCode,ye=ee.joinCodeRequired,xe=ee.systemMessages,Re=ee.hideSysMes,we=ee.retentionEnabled,be=ee.retentionOverrideGlobal,Ce=ee.retentionMaxAge,ve=ee.retentionExcludePinned,ge=ee.retentionFilesOnly,_e=ne.handleJoinCode,ke=ne.handleJoinCodeRequired,Ae=ne.handleSystemMessages,Pe=ne.handleEncrypted,Me=ne.handleHideSysMes,Se=ne.handleRoomName,Oe=ne.handleReadOnly,Ge=ne.handleArchived,Te=ne.handleRoomAvatar,De=ne.handleReactWhenReadOnly,je=ne.handleRoomType,Ne=ne.handleRoomTopic,Le=ne.handleRoomDescription,Ie=ne.handleRoomAnnouncement,Fe=ne.handleRetentionEnabled,Be=ne.handleRetentionOverrideGlobal,He=ne.handleRetentionMaxAge,We=ne.handleRetentionExcludePinned,qe=ne.handleRetentionFilesOnly,Je=u((function(){var e,t=(null===(e=G.getConfig(n.t))||void 0===e?void 0:e.allowRoomSettingChange)||function(){};return[t(n,T.NAME),t(n,T.TOPIC),t(n,T.ANNOUNCEMENT),t(n,T.ARCHIVE_OR_UNARCHIVE),t(n,T.DESCRIPTION),t(n,T.TYPE),t(n,T.READ_ONLY),t(n,T.SYSTEM_MESSAGES),t(n,T.JOIN_CODE),t(n,T.REACT_WHEN_READ_ONLY),t(n,T.E2E)]}),[n]),Ue=a(Je,11),Ve=Ue[0],ze=Ue[1],Ye=Ue[2],Ke=Ue[3],Qe=Ue[4],Xe=Ue[5],Ze=Ue[6],$e=Ue[7],en=Ue[8],nn=Ue[9],tn=Ue[10],ln=B("admin"),on=I("create-c"),an=I("create-p"),rn=Y(n,on,an,ln),cn=I("set-readonly",n._id),un=I("set-react-when-readonly",n._id),sn=I("edit-room-retention-policy",n._id),dn=F(u((function(){return["archive-room","unarchive-room"]}),[])),mn=I("delete-"+n.t),fn=I("toggle-room-e2e-encryption",n._id)&&(n.encrypted||J.isReady()),En=de!==!!n.archived,hn=n.archived?"unarchive":"archive",pn=n.archived?"Room_has_been_unarchived":"Room_has_been_archived",yn=H("POST","rooms.saveRoomSettings",q("Room_updated_successfully")),xn=H("POST","rooms.changeArchivationState",q(pn)),Rn=_(function(){function e(){var e,t,a,i,c,u;return l.async(function(){function s(s){for(;;)switch(s.prev=s.next){case 0:return e=X.current,t=e.joinCodeRequired,a=e.hideSysMes,delete(i=o(e,["joinCodeRequired","hideSysMes"])).archived,c=function(){return yn(r(r(r({rid:n._id},i),pe&&{joinCode:t?pe:""}),(i.systemMessages||!a)&&{systemMessages:a?xe:[]}))},u=function(){return xn({rid:n._id,action:hn})},s.next=6,l.awrap(Promise.all([te&&c(),En&&u()].filter(Boolean)));case 6:X.current={},oe();case 8:case"end":return s.stop()}}return s}(),null,null,null,Promise)}return e}()),wn=j("eraseRoom"),bn=_((function(){var e=function(){return z(void 0)},t=function(){function t(){return l.async(function(){function t(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.awrap(wn(n._id));case 2:e();case 3:case"end":return t.stop()}}return t}(),null,null,null,Promise)}return t}();z(i.createElement(M,{onConfirm:t,onCancel:e}))})),Cn=_((function(){je("p"===ie?"c":"p")})),vn=_((function(e){He(Math.max(1,Number(e.currentTarget.value)))}));return i.createElement(i.Fragment,null,i.createElement(k.Header,null,W&&i.createElement(k.Back,{onClick:W}),i.createElement(k.Text,null,q("edit-room")),t&&i.createElement(k.Close,{onClick:t})),i.createElement(k.ScrollableContent,{p:"x24",is:"form",onSubmit:_((function(e){return e.preventDefault()}))},i.createElement(C,{display:"flex",justifyContent:"center"},i.createElement(P,{room:n,roomAvatar:se,onChangeAvatar:Te})),i.createElement(d,null,i.createElement(d.Label,null,q("Name")),i.createElement(d.Row,null,i.createElement(m,{disabled:!Ve,value:re,onChange:Se,flexGrow:1}))),Qe&&i.createElement(d,null,i.createElement(d.Label,null,q("Description")),i.createElement(d.Row,null,i.createElement(g,{rows:4,value:fe,onChange:Le,flexGrow:1}))),Ye&&i.createElement(d,null,i.createElement(d.Label,null,q("Announcement")),i.createElement(d.Row,null,i.createElement(g,{rows:4,value:Ee,onChange:Ie,flexGrow:1}))),ze&&i.createElement(d,null,i.createElement(d.Label,null,q("Topic")),i.createElement(d.Row,null,i.createElement(g,{rows:4,value:me,onChange:Ne,flexGrow:1}))),Xe&&i.createElement(d,null,i.createElement(C,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},i.createElement(d.Label,null,q("Private")),i.createElement(d.Row,null,i.createElement(E,{disabled:!rn,checked:"p"===ie,onChange:Cn}))),i.createElement(d.Hint,null,q("Just_invited_people_can_access_this_channel"))),Ze&&i.createElement(d,null,i.createElement(C,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},i.createElement(d.Label,null,q("Read_only")),i.createElement(d.Row,null,i.createElement(E,{disabled:!cn,checked:ce,onChange:Oe}))),i.createElement(d.Hint,null,q("Only_authorized_users_can_write_new_messages"))),nn&&i.createElement(d,null,i.createElement(C,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},i.createElement(d.Label,null,q("React_when_read_only")),i.createElement(d.Row,null,i.createElement(E,{disabled:!un,checked:he,onChange:De}))),i.createElement(d.Hint,null,q("Only_authorized_users_can_write_new_messages"))),Ke&&i.createElement(d,null,i.createElement(C,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},i.createElement(d.Label,null,q("Archived")),i.createElement(d.Row,null,i.createElement(E,{disabled:!dn,checked:de,onChange:Ge})))),en&&i.createElement(d,null,i.createElement(C,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},i.createElement(d.Label,null,q("Password_to_access")),i.createElement(d.Row,null,i.createElement(E,{checked:ye,onChange:ke}))),i.createElement(d.Row,null,i.createElement(f,{disabled:!ye,value:pe,onChange:_e,placeholder:q("Reset_password"),flexGrow:1}))),$e&&i.createElement(d,null,i.createElement(C,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},i.createElement(d.Label,null,q("Hide_System_Messages")),i.createElement(d.Row,null,i.createElement(E,{checked:Re,onChange:Me}))),i.createElement(d.Row,null,i.createElement(h,{maxWidth:"100%",options:ae,disabled:!Re,value:xe,onChange:Ae,placeholder:q("Select_an_option"),flexGrow:1}))),tn&&i.createElement(d,null,i.createElement(C,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},i.createElement(d.Label,null,q("Encrypted")),i.createElement(d.Row,null,i.createElement(E,{disabled:!fn,checked:ue,onChange:Pe})))),K&&i.createElement(p,null,i.createElement(p.Item,{title:q("Prune")},i.createElement(R,null,i.createElement(d,null,i.createElement(C,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},i.createElement(d.Label,null,q("RetentionPolicyRoom_Enabled")),i.createElement(d.Row,null,i.createElement(E,{checked:we,onChange:Fe})))),i.createElement(d,null,i.createElement(C,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},i.createElement(d.Label,null,q("RetentionPolicyRoom_OverrideGlobal")),i.createElement(d.Row,null,i.createElement(E,{disabled:!we||!sn,checked:be,onChange:Be})))),be&&i.createElement(i.Fragment,null,i.createElement(y,{type:"danger"},i.createElement(A,null,q("RetentionPolicyRoom_ReadTheDocs"))),i.createElement(d,null,i.createElement(d.Label,null,q("RetentionPolicyRoom_MaxAge",{max:Q})),i.createElement(d.Row,null,i.createElement(x,{value:Ce,onChange:vn,flexGrow:1}))),i.createElement(d,null,i.createElement(C,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},i.createElement(d.Label,null,q("RetentionPolicyRoom_ExcludePinned")),i.createElement(d.Row,null,i.createElement(E,{checked:ve,onChange:We})))),i.createElement(d,null,i.createElement(C,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},i.createElement(d.Label,null,q("RetentionPolicyRoom_FilesOnly")),i.createElement(d.Row,null,i.createElement(E,{checked:ge,onChange:qe})))))))),i.createElement(d,null,i.createElement(d.Row,null,i.createElement(C,{display:"flex",flexDirection:"row",justifyContent:"space-between",w:"full"},i.createElement(b,{stretch:!0,flexGrow:1},i.createElement(w,{type:"reset",disabled:!te,onClick:le},q("Reset")),i.createElement(w,{flexGrow:1,disabled:!te,onClick:Rn},q("Save")))))),i.createElement(d,null,i.createElement(d.Row,null,i.createElement(w,{flexGrow:1,primary:!0,danger:!0,disabled:!mn,onClick:bn},i.createElement(v,{name:"trash",size:"x16"}),q("Delete"))))))}t.exportDefault(z)}

