function module(t,e,n){var i,r,u,s,a,o,c,l,h;n.link("@babel/runtime/helpers/createForOfIteratorHelperLoose",{default:function(t){i=t}},0),n.link("@babel/runtime/regenerator",{default:function(t){r=t}},1),n.link("@babel/runtime/helpers/createClass",{default:function(t){u=t}},2),n.link("@babel/runtime/helpers/assertThisInitialized",{default:function(t){s=t}},3),n.link("@babel/runtime/helpers/inheritsLoose",{default:function(t){a=t}},4),n.link("@babel/runtime/helpers/classPrivateFieldLooseBase",{default:function(t){o=t}},5),n.link("@babel/runtime/helpers/classPrivateFieldLooseKey",{default:function(t){c=t}},6),n.export({RecordList:function(){return y}}),n.link("@rocket.chat/emitter",{Emitter:function(t){l=t}},0),n.link("../asyncState",{AsyncStatePhase:function(t){h=t}},1);var f=c("hasChanges"),d=c("index"),v=c("phase"),m=c("items"),p=c("itemCount"),b=c("pedingMutation"),y=function(t){function e(){var e;return e=t.apply(this,arguments)||this,Object.defineProperty(s(e),f,{writable:!0,value:void 0}),Object.defineProperty(s(e),d,{writable:!0,value:void 0}),Object.defineProperty(s(e),v,{writable:!0,value:void 0}),Object.defineProperty(s(e),m,{writable:!0,value:void 0}),Object.defineProperty(s(e),p,{writable:!0,value:void 0}),Object.defineProperty(s(e),b,{writable:!0,value:void 0}),o(s(e),f)[f]=!1,o(s(e),d)[d]=new Map,o(s(e),v)[v]=h.LOADING,o(s(e),m)[m]=void 0,o(s(e),p)[p]=void 0,o(s(e),b)[b]=Promise.resolve(),e}a(e,t);var n=e.prototype;return n.filter=function(){function t(t){return!0}return t}(),n.compare=function(){function t(t,e){return t._updatedAt.getTime()-e._updatedAt.getTime()}return t}(),n.insert=function(){function t(t){o(this,d)[d].set(t._id,t),this.emit(t._id+"/inserted",t),"number"==typeof o(this,p)[p]&&o(this,p)[p]++,o(this,f)[f]=!0}return t}(),n.update=function(){function t(t){o(this,d)[d].set(t._id,t),this.emit(t._id+"/updated",t),o(this,f)[f]=!0}return t}(),n.delete=function(){function t(t){o(this,d)[d].delete(t),this.emit(t+"/deleted"),"number"==typeof o(this,p)[p]&&o(this,p)[p]--,o(this,f)[f]=!0}return t}(),n.push=function(){function t(t){var e=o(this,d)[d].has(t._id),n=this.filter(t);!e||n?e&&n?this.update(t):!e&&n&&this.insert(t):this.delete(t._id)}return t}(),n.mutate=function(){function t(t){var e;return r.async(function(){function n(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o(this,v)[v]===h.RESOLVED&&(o(this,v)[v]=h.UPDATING,this.emit("mutating")),o(this,b)[b]=o(this,b)[b].then(t),n.next=5,r.awrap(o(this,b)[b]);case 5:n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),this.emit("errored",n.t0);case 10:return n.prev=10,e=o(this,f)[f],o(this,v)[v]=h.RESOLVED,e&&(o(this,m)[m]=void 0,o(this,f)[f]=!1),this.emit("mutated",e),n.finish(10);case 16:case"end":return n.stop()}}return n}(),null,this,[[0,7,10,16]],Promise)}return t}(),n.batchHandle=function(){function t(t){var e=this;return this.mutate(function(){function n(){var n,u,s,a;return r.async(function(){function c(c){for(;;)switch(c.prev=c.next){case 0:return c.next=2,r.awrap(t());case 2:if((n=c.sent).items)for(u=i(n.items);!(s=u()).done;)a=s.value,e.push(a);n.itemCount&&(o(e,p)[p]=n.itemCount,o(e,f)[f]=!0);case 5:case"end":return c.stop()}}return c}(),null,null,null,Promise)}return n}())}return t}(),n.prune=function(){function t(t){var e=this;return this.mutate((function(){for(var n=i(o(e,d)[d].values()),r;!(r=n()).done;){var u=r.value;t(u)&&e.delete(u._id)}}))}return t}(),n.handle=function(){function t(t){var e=this;return this.mutate((function(){e.push(t)}))}return t}(),n.remove=function(){function t(t){var e=this;return this.mutate((function(){o(e,d)[d].has(t)&&e.delete(t)}))}return t}(),n.clear=function(){function t(){var t=this;return this.mutate((function(){0!==o(t,d)[d].size&&(o(t,d)[d].clear(),o(t,m)[m]=void 0,o(t,p)[p]=void 0,o(t,f)[f]=!0,t.emit("cleared"))}))}return t}(),u(e,[{key:"phase",get:function(){return o(this,v)[v]}},{key:"items",get:function(){return o(this,m)[m]||(o(this,m)[m]=Array.from(o(this,d)[d].values()).sort(this.compare)),o(this,m)[m]}},{key:"itemCount",get:function(){var t;return null!==(t=o(this,p)[p])&&void 0!==t?t:o(this,d)[d].size}}]),e}(l)}

