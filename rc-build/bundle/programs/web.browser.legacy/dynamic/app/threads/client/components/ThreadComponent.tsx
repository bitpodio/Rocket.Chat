function module(n,e,t){var r,i,u,o,a,c,l,s,f,d,p,m,v,g,k,x,b,h,T,w,_,M,C,y,E;t.link("@babel/runtime/regenerator",{default:function(n){r=n}},0),t.link("@babel/runtime/helpers/objectSpread2",{default:function(n){i=n}},1),t.link("@babel/runtime/helpers/slicedToArray",{default:function(n){u=n}},2),t.link("react",{default:function(n){o=n},useEffect:function(n){a=n},useRef:function(n){c=n},useState:function(n){l=n},useCallback:function(n){s=n},useMemo:function(n){f=n}},0),t.link("meteor/templating",{Template:function(n){d=n}},1),t.link("meteor/blaze",{Blaze:function(n){p=n}},2),t.link("meteor/tracker",{Tracker:function(n){m=n}},3),t.link("@rocket.chat/fuselage-hooks",{useLocalStorage:function(n){v=n}},4),t.link("../../../models/client",{ChatMessage:function(n){g=n}},5),t.link("../../../../client/contexts/RouterContext",{useRoute:function(n){k=n}},6),t.link("../../../utils/client",{roomTypes:function(n){x=n}},7),t.link("../lib/normalizeThreadTitle",{normalizeThreadTitle:function(n){b=n}},8),t.link("../../../../client/contexts/UserContext",{useUserId:function(n){h=n},useUserSubscription:function(n){T=n}},9),t.link("../../../../client/contexts/ServerContext",{useEndpoint:function(n){w=n},useMethod:function(n){_=n}},10),t.link("../../../../client/contexts/ToastMessagesContext",{useToastMessageDispatch:function(n){M=n}},11),t.link("./ThreadSkeleton",{default:function(n){C=n}},12),t.link("./ThreadView",{default:function(n){y=n}},13),t.link("../../../../client/views/room/providers/ToolboxProvider",{useTabBarOpenUserInfo:function(n){E=n}},14);var S={},U=function(n){var e=l((function(){return m.nonreactive((function(){return g.findOne({_id:n})}))})),t=u(e,2),o=t[0],c=t[1],f=w("GET","chat.getMessage"),d=s(function(){function n(n){var e,t;return r.async(function(){function u(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,r.awrap(f(n));case 2:return e=u.sent,t=e.message,u.abrupt("return",i(i({},t),{},{_updatedAt:new Date(t._updatedAt)}));case 5:case"end":return u.stop()}}return u}(),null,null,null,Promise)}return n}(),[f]);return a((function(){var e=m.autorun(function(){function e(e){var t;return r.async(function(){function i(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=g.findOne({_id:n}),i.t0){i.next=5;break}return i.next=4,r.awrap(d({msgId:n}));case 4:i.t0=i.sent;case 5:if((t=i.t0)&&!e.stopped){i.next=8;break}return i.abrupt("return");case 8:c((function(n){var e,r;return n&&n._id===t._id&&(null===(e=n._updatedAt)||void 0===e?void 0:e.getTime())===(null===(r=t._updatedAt)||void 0===r?void 0:r.getTime())?n:t}));case 9:case"end":return i.stop()}}return i}(),null,null,null,Promise)}return e}());return function(){e.stop()}}),[d,n]),o},A=function(n){var e,t,i=n.mid,m=n.jump,g=n.room,w=T(g._id,S),A=k(x.getConfig(g.t).route.name),I=U(i),j=E(),z=c(null),B=h(),D=f((function(){return I?b(I):null}),[I]),P=v("expand-threads",!1),O=u(P,2),R=O[0],F=O[1],G=!!B&&(null!==(e=null==I?void 0:null===(t=I.replies)||void 0===t?void 0:t.includes(B))&&void 0!==e&&e),L=M(),V=_("followMessage"),W=_("unfollowMessage"),q=s(function(){function n(n){return r.async(function(){function e(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!n){e.next=5;break}return e.next=4,r.awrap(V({mid:i}));case 4:return e.abrupt("return");case 5:return e.next=7,r.awrap(W({mid:i}));case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),L({type:"error",message:e.t0});case 12:case"end":return e.stop()}}return e}(),null,null,[[0,9]],Promise)}return n}(),[L,V,W,i]),H=s((function(){A.push("d"===g.t?{rid:g._id}:{name:g.name})}),[A,g._id,g.t,g.name]),J=l((function(){return{mainMessage:I,jump:m,following:G,subscription:w,rid:g._id,tabBar:{openUserInfo:j}}})),K=u(J,2),N=K[0],Q=K[1];return a((function(){Q((function(n){var e;return I&&(null===(e=n.mainMessage)||void 0===e?void 0:e._id)!==I._id?{mainMessage:I,jump:m,following:G,subscription:w,rid:g._id,tabBar:{openUserInfo:j}}:n}))}),[G,m,j,g._id,w,I]),a((function(){if(z.current&&N.mainMessage){var n=p.renderWithData(d.thread,N,z.current);return function(){p.remove(n)}}}),[N]),I?o.createElement(y,{ref:z,title:D,expanded:R,following:G,onToggleExpand:function(n){return F(!n)},onToggleFollow:function(n){return q(!n)},onClose:H}):o.createElement(C,{expanded:R,onClose:H})};t.exportDefault(A)}

