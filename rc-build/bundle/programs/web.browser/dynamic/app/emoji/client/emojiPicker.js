function module(e,t,o){let a,r,c,n,s,i,g,l,p;o.export({updateRecentEmoji:()=>j}),o.link("underscore",{default(e){a=e}},0),o.link("meteor/reactive-var",{ReactiveVar(e){r=e}},1),o.link("meteor/reactive-dict",{ReactiveDict(e){c=e}},2),o.link("meteor/kadira:flow-router",{FlowRouter(e){n=e}},3),o.link("meteor/templating",{Template(e){s=e}},4),o.link("../../../lib/escapeRegExp",{escapeRegExp(e){i=e}},5),o.link("../../theme/client/imports/components/emojiPicker.css"),o.link("../../utils/client",{t(e){g=e}},6),o.link("./lib/EmojiPicker",{EmojiPicker(e){l=e}},7),o.link("../lib/rocketchat",{emoji(e){p=e}},8),o.link("./emojiPicker.html");const m=27,k=new c("emojiList"),u=(e,t)=>t&&'<li class="emoji-'.concat(e,' emoji-picker-item" data-emoji="').concat(e,'" title="').concat(e,'">').concat(t,"</li>"),h=(e,t)=>{const o=Object.values(p.packages).map(o=>{if(o.emojisByCategory&&o.emojisByCategory[e])return o.emojisByCategory[e].map(e=>{const a=t>0&&o.toneList.hasOwnProperty(e)?"_tone".concat(t):"";return u(e,o.renderPicker(":".concat(e).concat(a,":")))}).join("")}).join("")||"<li>".concat(g("No_emojis_found"),"</li>");return o};function j(e){k.set(e,h(e))}const y=e=>{const t=e.categoriesList,o=e.tone;t.forEach(e=>k.set(e.key,h(e.key,o)))};function f(e){let t='<ul class="emoji-list">';const o=s.instance(),a=o.tone;l.currentCategory.set("");const r=new RegExp(i(e.replace(/:/g,"")),"i");for(let c in p.list)if(p.list.hasOwnProperty(c)&&r.test(c)){const o=p.list[c],{emojiPackage:r,shortnames:n=[]}=o;let s="";c=c.replace(/:/g,"");const i=void 0!==n[0]?n[0].replace(/:/g,""):n[0];a>0&&p.packages[r].toneList.hasOwnProperty(p)&&(s="_tone".concat(a));let g=!1;for(const t in p.packages[r].emojisByCategory)if(p.packages[r].emojisByCategory.hasOwnProperty(t)){const o=p.packages[r].emojisByCategory[t],a=void 0!==i?i.replace(/:/g,"").split("_"):i;if(-1!==o.indexOf(c)||void 0!==a&&a.includes(e)){g=!0;break}}if(g){const e=p.packages[r].renderPicker(":".concat(c).concat(s,":"));t+=u(c,e)}}return t+="</ul>"}s.emojiPicker.helpers({emojiCategories:()=>s.instance().categoriesList,emojiByCategory(e){let t=[];for(const o in p.packages)p.packages.hasOwnProperty(o)&&p.packages[o].emojisByCategory.hasOwnProperty(e)&&(t=t.concat(p.packages[o].emojisByCategory[e]));return t},searching:()=>s.instance().currentSearchTerm.get().length>0,searchResults:()=>f(s.instance().currentSearchTerm.get()),emojiList:e=>k.get(e),currentTone:()=>"tone-".concat(s.instance().tone),activeCategory:e=>l.currentCategory.get()===e?"active":"",currentCategory:()=>l.currentCategory.get()}),s.emojiPicker.events({"click .emoji-picker"(e){e.stopPropagation(),e.preventDefault()},"click .add-custom"(e){e.stopPropagation(),e.preventDefault(),n.go("/admin/emoji-custom"),l.close()},"click .category-link":e=>(e.stopPropagation(),e.preventDefault(),l.showCategory(e.currentTarget.hash.substr(1)),!1),"scroll .emojis":a.throttle((e,t)=>{if(l.scrollingToCategory)return;const o=t.$(e.currentTarget),a=o.scrollTop()+8,r=l.getCategoryPositions().filter(e=>e.top<=a).pop();if(!r)return;const{el:c}=r,n=c.id.replace("emoji-list-category-","");l.currentCategory.set(n)},300),"click .change-tone > a"(e,t){e.stopPropagation(),e.preventDefault(),t.$(".tone-selector").toggleClass("show")},"click .tone-selector .tone"(e,t){e.stopPropagation(),e.preventDefault();const o=parseInt(e.currentTarget.dataset.tone);let a;a=o>0?"_tone".concat(o):"";for(const r in p.packages)if(p.packages.hasOwnProperty(r)&&p.packages[r].hasOwnProperty("toneList"))for(const e in p.packages[r].toneList)p.packages[r].toneList.hasOwnProperty(e)&&$(".emoji-".concat(e)).html(p.packages[r].render(":".concat(e).concat(a,":")));l.setTone(o),t.setCurrentTone(o),$(".tone-selector").toggleClass("show")},"click .emoji-list .emoji-picker-item"(e,t){e.stopPropagation();const o=e.currentTarget.dataset.emoji,a=t.tone;let r="";for(const n in p.packages)p.packages.hasOwnProperty(n)&&a>0&&p.packages[n].toneList.hasOwnProperty(o)&&(r="_tone".concat(a));const c=$(".emoji-picker .js-emojipicker-search");c&&c.val(""),t.currentSearchTerm.set(""),l.pickEmoji(o+r)},"keyup .js-emojipicker-search, change .js-emojipicker-search"(e,t){if(e.preventDefault(),e.stopPropagation(),27===e.keyCode)return l.close();const o=e.target.value.trim(),a=t.currentSearchTerm;o!==a.get()&&a.set(o)}}),s.emojiPicker.onCreated((function(){this.tone=l.getTone();const e=l.getRecent();this.currentSearchTerm=new r(""),this.categoriesList=[];for(const t in p.packages)p.packages.hasOwnProperty(t)&&p.packages[t].emojiCategories&&(void 0!==p.packages[t].categoryIndex?this.categoriesList.splice(p.packages[t].categoryIndex,0,...p.packages[t].emojiCategories):this.categoriesList=this.categoriesList.concat(p.packages[t].emojiCategories));e.forEach(e=>{p.packages.base.emojisByCategory.recent.push(e)}),this.setCurrentTone=e=>{$(".current-tone").removeClass("tone-".concat(this.tone)),$(".current-tone").addClass("tone-".concat(e)),this.tone=e},y(this)}))}

