function module(e,t,a){let n,s,l,o,r,c,u,i,d,m,_,h,g,v,w,C,y,A,p,k,x,f,U;a.link("@babel/runtime/helpers/objectSpread2",{default(e){n=e}},0),a.link("@rocket.chat/fuselage",{ButtonGroup(e){s=e},Button(e){l=e},Box(e){o=e},Icon(e){r=e}},0),a.link("meteor/sha",{SHA256(e){c=e}},1),a.link("react",{default(e){u=e},useMemo(e){i=e},useState(e){d=e},useCallback(e){m=e}},2),a.link("../../components/Page",{default(e){_=e}},3),a.link("./AccountProfileForm",{default(e){h=e}},4),a.link("../../components/ConfirmOwnerChangeWarningModal",{default(e){g=e}},5),a.link("../../contexts/TranslationContext",{useTranslation(e){v=e}},6),a.link("../../hooks/useForm",{useForm(e){w=e}},7),a.link("../../contexts/SettingsContext",{useSetting(e){C=e}},8),a.link("../../contexts/UserContext",{useUser(e){y=e}},9),a.link("../../contexts/ToastMessagesContext",{useToastMessageDispatch(e){A=e}},10),a.link("../../contexts/ServerContext",{useMethod(e){p=e}},11),a.link("../../contexts/ModalContext",{useSetModal(e){k=e}},12),a.link("../../hooks/useUpdateAvatar",{useUpdateAvatar(e){x=e}},13),a.link("../../lib/getUserEmailAddress",{getUserEmailAddress(e){f=e}},14),a.link("./ActionConfirmModal",{default(e){U=e}},15);const E=e=>{var t,a,n,s,l,o,r,c,u;return{realname:null!==(t=e.name)&&void 0!==t?t:"",email:null!==(a=f(e))&&void 0!==a?a:"",username:null!==(n=e.username)&&void 0!==n?n:"",password:"",confirmationPassword:"",avatar:"",url:null!==(s=e.avatarUrl)&&void 0!==s?s:"",statusText:null!==(l=e.statusText)&&void 0!==l?l:"",statusType:null!==(o=e.status)&&void 0!==o?o:"",bio:null!==(r=e.bio)&&void 0!==r?r:"",customFields:null!==(c=e.customFields)&&void 0!==c?c:{},nickname:null!==(u=e.nickname)&&void 0!==u?u:""}},b=()=>{var e,t,a;const b=v(),S=A(),P=y(),{values:T,handlers:F,hasUnsavedChanges:M,commit:O}=w(E(P)),[D,B]=d(!0),R=k(),[L,N]=d(!1),W=p("logoutOtherClients"),q=p("deleteUserOwnAccount"),G=p("saveUserProfile"),H=m(()=>R(null),[R]),I=Boolean(null==P?void 0:null===(e=P.services)||void 0===e?void 0:null===(t=e.password)||void 0===t?void 0:null===(a=t.bcrypt)||void 0===a?void 0:a.trim()),j=C("Message_ErasureType"),z=C("Accounts_AllowRealNameChange"),V=C("Accounts_AllowUserStatusMessageChange"),$=C("Accounts_AllowUsernameChange"),J=C("Accounts_AllowEmailChange");let K=C("Accounts_AllowPasswordChange");const Q=C("Accounts_AllowPasswordChangeForOAuthUsers"),X=C("Accounts_AllowUserAvatarChange"),Y=C("Accounts_AllowDeleteOwnAccount"),Z=C("LDAP_Enable"),ee=C("LDAP_Username_Field"),te=Z&&ee,ae=C("Accounts_RequireNameForSignUp"),ne=C("UTF8_Names_Validation");var se,le;K&&!Q&&(K=Boolean(null==P?void 0:null===(se=P.services)||void 0===se?void 0:null===(le=se.password)||void 0===le?void 0:le.bcrypt));const oe=i(()=>new RegExp("^".concat(ne,"$")),[ne]),re=$&&!te,ce=i(()=>({allowRealNameChange:z,allowUserStatusMessageChange:V,allowEmailChange:J,allowPasswordChange:K,allowUserAvatarChange:X,allowDeleteOwnAccount:Y,canChangeUsername:re,requireName:ae,namesRegex:oe}),[Y,J,K,z,X,V,re,ae,oe]),{realname:ue,email:ie,avatar:de,username:me,password:_e,statusText:he,statusType:ge,customFields:ve,bio:we,nickname:Ce}=T,{handleAvatar:ye,handlePassword:Ae,handleConfirmationPassword:pe}=F,ke=x(de,P._id),xe=m(async()=>{const e=async e=>{try{await G(n(n(n(n(n(n(n({},z&&{realname:ue}),J&&f(P)!==ie&&{email:ie}),K&&{newPassword:_e}),re&&{username:me}),V&&{statusText:he}),e&&{typedPassword:c(e)}),{},{statusType:ge,nickname:Ce,bio:we||""}),ve),Ae(""),pe("");const t=await ke();t&&ye(""),O(),S({type:"success",message:b("Profile_saved_successfully")})}catch(t){S({type:"error",message:t})}};e()},[G,J,K,z,V,we,re,ie,_e,ue,he,me,P,ke,ye,S,b,ve,ge,O,Ce,Ae,pe]),fe=m(async()=>{N(!0);try{await W(),S({type:"success",message:b("Logged_out_of_other_clients_successfully")})}catch(e){S({type:"error",message:e})}N(!1)},[W,S,b]),Ue=m(async()=>{const e=async e=>{try{await q(c(e)),S({type:"success",message:b("User_has_been_deleted")})}catch(t){if("user-last-owner"===t.error){const{shouldChangeOwner:a,shouldBeRemoved:n}=t.details;return R(()=>u.createElement(g,{onConfirm:()=>{q(c(e),!0)},onCancel:H,contentTitle:b("Delete_User_Warning_".concat(j)),confirmLabel:b("Continue"),shouldChangeOwner:a,shouldBeRemoved:n}))}S({type:"error",message:t})}},t=b("Are_you_sure_you_want_to_delete_your_account");return R(I?()=>u.createElement(U,{onSave:e,onCancel:H,title:t,text:b("For_your_security_you_must_enter_your_current_password_to_continue"),isPassword:!0}):()=>u.createElement(U,{onSave:e,onCancel:H,title:t,text:b("If_you_are_sure_type_in_your_username"),isPassword:!0}))},[H,q,S,j,I,b,R]);return u.createElement(_,null,u.createElement(_.Header,{title:b("Profile")},u.createElement(s,null,u.createElement(l,{primary:!0,disabled:!M||!D||L,onClick:xe},b("Save_changes")))),u.createElement(_.ScrollableContentWithShadow,null,u.createElement(o,{maxWidth:"600px",w:"full",alignSelf:"center"},u.createElement(h,{values:T,handlers:F,user:P,settings:ce,onSaveStateChange:B}),u.createElement(s,{stretch:!0,mb:"x12"},u.createElement(l,{onClick:fe,flexGrow:0,disabled:L},b("Logout_Others")),Y&&u.createElement(l,{danger:!0,onClick:Ue},u.createElement(r,{name:"trash",size:"x20",mie:"x4"}),b("Delete_my_account"))))))};a.exportDefault(b)}

