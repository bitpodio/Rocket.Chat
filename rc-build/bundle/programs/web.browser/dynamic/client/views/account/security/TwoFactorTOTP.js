function module(e,t,a){let n,o,r,c,l,s,i,u,d,m,f,_,y,k,h,E,p,g,x,C;a.link("@babel/runtime/helpers/extends",{default(e){n=e}},0),a.link("react",{default(e){o=e},useState(e){r=e},useCallback(e){c=e},useEffect(e){l=e}},0),a.link("@rocket.chat/fuselage",{Box(e){s=e},Button(e){i=e},TextInput(e){u=e},Margins(e){d=e}},1),a.link("@rocket.chat/fuselage-hooks",{useSafely(e){m=e}},2),a.link("yaqrcode",{default(e){f=e}},3),a.link("../../../contexts/UserContext",{useUser(e){_=e}},4),a.link("../../../contexts/ToastMessagesContext",{useToastMessageDispatch(e){y=e}},5),a.link("../../../contexts/ModalContext",{useSetModal(e){k=e}},6),a.link("../../../contexts/TranslationContext",{useTranslation(e){h=e}},7),a.link("../../../hooks/useForm",{useForm(e){E=e}},8),a.link("../../../contexts/ServerContext",{useMethod(e){p=e}},9),a.link("../../../components/TextCopy",{default(e){g=e}},10),a.link("./BackupCodesModal",{default(e){x=e}},11),a.link("./VerifyCodeModal",{default(e){C=e}},12);const w=e=>{const t=h(),a=y(),w=_(),b=k(),v=p("2fa:enable"),T=p("2fa:disable"),M=p("2fa:validateTempToken"),S=p("2fa:checkCodesRemaining"),D=p("2fa:regenerateCodes"),[F,I]=m(r(!1)),[B,R]=m(r()),[V,z]=m(r()),[Q,U]=m(r()),{values:q,handlers:A}=E({authCode:""}),{authCode:Y}=q,{handleAuthCode:j}=A,G=w&&w.services&&w.services.totp&&w.services.totp.enabled,H=c(()=>b(null),[b]);l(()=>{const e=async()=>{if(!G)return!1;const e=await S();U(e.remaining)};e()},[S,U,G]);const J=c(async()=>{try{const e=await v();z(e.secret),R(f(e.url,{size:200})),I(!0)}catch(e){a({type:"error",message:e})}},[a,v,R,I,z]),K=c(async()=>{const e=async e=>{try{const n=await T(e);if(!n)return a({type:"error",message:t("Invalid_two_factor_code")});a({type:"success",message:t("Two-factor_authentication_disabled")})}catch(n){a({type:"error",message:n})}H()};b(o.createElement(C,{onVerify:e,onCancel:H}))},[H,T,a,b,t]),L=c(async()=>{try{const e=await M(Y);if(!e)return a({type:"error",message:t("Invalid_two_factor_code")});b(o.createElement(x,{codes:e.codes,onClose:H}))}catch(e){a({type:"error",message:e})}},[Y,H,a,b,t,M]),N=c(()=>{const e=async e=>{try{const n=await D(e);if(!n)return a({type:"error",message:t("Invalid_two_factor_code")});b(o.createElement(x,{codes:n.codes,onClose:H}))}catch(n){a({type:"error",message:n})}};b(o.createElement(C,{onVerify:e,onCancel:H}))},[H,a,D,b,t]);return o.createElement(s,n({display:"flex",flexDirection:"column",alignItems:"flex-start"},e),o.createElement(d,{blockEnd:"x8"},o.createElement(s,{fontScale:"s2"},t("Two-factor_authentication")),!G&&!F&&o.createElement(o.Fragment,null,o.createElement(s,null,t("Two-factor_authentication_is_currently_disabled")),o.createElement(i,{primary:!0,onClick:J},t("Enable_two-factor_authentication"))),!G&&F&&o.createElement(o.Fragment,null,o.createElement(s,null,t("Scan_QR_code")),o.createElement(s,null,t("Scan_QR_code_alternative_s")),o.createElement(g,{text:V}),o.createElement(s,{is:"img",size:"x200",src:B,"aria-hidden":"true"}),o.createElement(s,{display:"flex",flexDirection:"row",w:"full"},o.createElement(u,{placeholder:t("Enter_authentication_code"),value:Y,onChange:j}),o.createElement(i,{primary:!0,onClick:L},t("Verify")))),G&&o.createElement(o.Fragment,null,o.createElement(i,{primary:!0,danger:!0,onClick:K},t("Disable_two-factor_authentication")),o.createElement(s,{fontScale:"p2",mbs:"x8"},t("Backup_codes")),o.createElement(s,null,t("You_have_n_codes_remaining",{number:Q})),o.createElement(i,{onClick:N},t("Regenerate_codes")))))};a.exportDefault(w)}

