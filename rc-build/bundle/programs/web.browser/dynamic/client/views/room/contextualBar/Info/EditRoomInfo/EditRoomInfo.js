function module(e,n,t){let l,o,a,r,i,c,s,d,m,u,E,h,y,p,f,R,x,w,C,b,g,_,v,k,A,P,M,S,O,G,T,D,j,N,L,I,F,B,H,W;t.link("@babel/runtime/helpers/objectWithoutProperties",{default(e){l=e}},0),t.link("@babel/runtime/helpers/objectSpread2",{default(e){o=e}},1),t.link("react",{default(e){a=e},useCallback(e){r=e},useMemo(e){i=e},useRef(e){c=e}},0),t.link("@rocket.chat/fuselage",{Field(e){s=e},TextInput(e){d=e},PasswordInput(e){m=e},ToggleSwitch(e){u=e},MultiSelect(e){E=e},Accordion(e){h=e},Callout(e){y=e},NumberInput(e){p=e},FieldGroup(e){f=e},Button(e){R=e},ButtonGroup(e){x=e},Box(e){w=e},Icon(e){C=e},TextAreaInput(e){b=e}},1),t.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){g=e}},2),t.link("../../../../../components/VerticalBar",{default(e){_=e}},3),t.link("../../../../../components/RawText",{default(e){v=e}},4),t.link("../../../../../components/avatar/RoomAvatarEditor",{default(e){k=e}},5),t.link("../../../../../components/DeleteChannelWarning",{default(e){A=e}},6),t.link("../../../../../contexts/TranslationContext",{useTranslation(e){P=e}},7),t.link("../../../../../hooks/useForm",{useForm(e){M=e}},8),t.link("../../../../../../app/utils/client",{roomTypes(e){S=e},RoomSettingsEnum(e){O=e}},9),t.link("../../../../../../app/lib/lib/MessageTypes",{MessageTypesValues(e){G=e}},10),t.link("../../../../../contexts/ServerContext",{useMethod(e){T=e}},11),t.link("../../../../../contexts/ModalContext",{useSetModal(e){D=e}},12),t.link("../../../../../contexts/SettingsContext",{useSetting(e){j=e}},13),t.link("../../../../../contexts/AuthorizationContext",{usePermission(e){N=e},useAtLeastOnePermission(e){L=e},useRole(e){I=e}},14),t.link("../../../../../hooks/useEndpointAction",{useEndpointActionExperimental(e){F=e}},15),t.link("../../../hooks/useUserRoom",{useUserRoom(e){B=e}},16),t.link("../../../providers/ToolboxProvider",{useTabBarClose(e){H=e}},17),t.link("../../../../../../app/e2e/client/rocketchat.e2e",{e2e(e){W=e}},18);const q={c:"Channels",p:"Groups",d:"DMs"},J=(e,n)=>{const{t:t,ro:l,archived:a,topic:r,description:c,announcement:s,joinCodeRequired:d,sysMes:m,encrypted:u,retention:E={}}=e,{retentionPolicyEnabled:h,maxAgeDefault:y}=n,p=j("RetentionPolicy_AppliesTo".concat(q[e.t])),f=j("RetentionPolicy_DoNotPrunePinned"),R=j("RetentionPolicy_FilesOnly");return i(()=>{var n,i,x;return o({roomName:"d"===t?e.usernames.join(" x "):S.getRoomName(t,o({type:t},e)),roomType:t,readOnly:!!l,reactWhenReadOnly:!1,archived:!!a,roomTopic:null!=r?r:"",roomDescription:null!=c?c:"",roomAnnouncement:null!=s?s:"",roomAvatar:void 0,joinCode:"",joinCodeRequired:!!d,systemMessages:Array.isArray(m)?m:[],hideSysMes:!(null==m||!m.length),encrypted:u},h&&{retentionEnabled:null!==(n=E.enabled)&&void 0!==n?n:p,retentionOverrideGlobal:!!E.overrideGlobal,retentionMaxAge:Math.min(E.maxAge,y)||y,retentionExcludePinned:null!==(i=E.excludePinned)&&void 0!==i?i:f,retentionFilesOnly:null!==(x=E.filesOnly)&&void 0!==x?x:R})},[s,a,c,f,R,d,y,E.enabled,E.excludePinned,E.filesOnly,E.maxAge,E.overrideGlobal,p,h,l,e,m,t,r,u])};function U(e){let{rid:n,onClickBack:t}=e;const l=B(n),r=H();return a.createElement(z,{onClickClose:r,onClickBack:t,room:o({type:null==l?void 0:l.t},l)})}const V=(e,n,t,l)=>(!e.default||l)&&("p"===e.t&&n||"c"===e.t&&t);function z(e){let{room:n,onClickClose:t,onClickBack:B}=e;const H=P(),U=D(),z=j("RetentionPolicy_Enabled"),Y=j("RetentionPolicy_MaxAge_".concat(q[n.t]))||30,K=c({}),Q=r(e=>{let{initialValue:n,value:t,key:l}=e;const{current:o}=K;JSON.stringify(n)!==JSON.stringify(t)?("systemMessages"===l&&(null==t?void 0:t.length)>0&&(o.hideSysMes=!0),o[l]=t):delete o[l]},[]),{values:X,handlers:Z,hasUnsavedChanges:$,reset:ee,commit:ne}=M(J(n,{retentionPolicyEnabled:z,maxAgeDefault:Y}),Q),te=i(()=>G.map(e=>{let{key:n,i18nLabel:t}=e;return[n,H(t)]}),[H]),{roomName:le,roomType:oe,readOnly:ae,encrypted:re,roomAvatar:ie,archived:ce,roomTopic:se,roomDescription:de,roomAnnouncement:me,reactWhenReadOnly:ue,joinCode:Ee,joinCodeRequired:he,systemMessages:ye,hideSysMes:pe,retentionEnabled:fe,retentionOverrideGlobal:Re,retentionMaxAge:xe,retentionExcludePinned:we,retentionFilesOnly:Ce}=X,{handleJoinCode:be,handleJoinCodeRequired:ge,handleSystemMessages:_e,handleEncrypted:ve,handleHideSysMes:ke,handleRoomName:Ae,handleReadOnly:Pe,handleArchived:Me,handleRoomAvatar:Se,handleReactWhenReadOnly:Oe,handleRoomType:Ge,handleRoomTopic:Te,handleRoomDescription:De,handleRoomAnnouncement:je,handleRetentionEnabled:Ne,handleRetentionOverrideGlobal:Le,handleRetentionMaxAge:Ie,handleRetentionExcludePinned:Fe,handleRetentionFilesOnly:Be}=Z,[He,We,qe,Je,Ue,Ve,ze,Ye,Ke,Qe,Xe]=i(()=>{var e;const t=(null===(e=S.getConfig(n.t))||void 0===e?void 0:e.allowRoomSettingChange)||(()=>{});return[t(n,O.NAME),t(n,O.TOPIC),t(n,O.ANNOUNCEMENT),t(n,O.ARCHIVE_OR_UNARCHIVE),t(n,O.DESCRIPTION),t(n,O.TYPE),t(n,O.READ_ONLY),t(n,O.SYSTEM_MESSAGES),t(n,O.JOIN_CODE),t(n,O.REACT_WHEN_READ_ONLY),t(n,O.E2E)]},[n]),Ze=I("admin"),$e=N("create-c"),en=N("create-p"),nn=V(n,$e,en,Ze),tn=N("set-readonly",n._id),ln=N("set-react-when-readonly",n._id),on=N("edit-room-retention-policy",n._id),an=L(i(()=>["archive-room","unarchive-room"],[])),rn=N("delete-".concat(n.t)),cn=N("toggle-room-e2e-encryption",n._id)&&(n.encrypted||W.isReady()),sn=ce!==!!n.archived,dn=n.archived?"unarchive":"archive",mn=n.archived?"Room_has_been_unarchived":"Room_has_been_archived",un=F("POST","rooms.saveRoomSettings",H("Room_updated_successfully")),En=F("POST","rooms.changeArchivationState",H(mn)),hn=g(async()=>{const e=K.current,{joinCodeRequired:t,hideSysMes:a}=e,r=l(e,["joinCodeRequired","hideSysMes"]);delete r.archived;const i=()=>un(o(o(o({rid:n._id},r),Ee&&{joinCode:t?Ee:""}),(r.systemMessages||!a)&&{systemMessages:a?ye:[]})),c=()=>En({rid:n._id,action:dn});await Promise.all([$&&i(),sn&&c()].filter(Boolean)),K.current={},ne()}),yn=T("eraseRoom"),pn=g(()=>{const e=()=>U(void 0),t=async()=>{await yn(n._id),e()};U(a.createElement(A,{onConfirm:t,onCancel:e}))}),fn=g(()=>{Ge("p"===oe?"c":"p")}),Rn=g(e=>{Ie(Math.max(1,Number(e.currentTarget.value)))});return a.createElement(a.Fragment,null,a.createElement(_.Header,null,B&&a.createElement(_.Back,{onClick:B}),a.createElement(_.Text,null,H("edit-room")),t&&a.createElement(_.Close,{onClick:t})),a.createElement(_.ScrollableContent,{p:"x24",is:"form",onSubmit:g(e=>e.preventDefault())},a.createElement(w,{display:"flex",justifyContent:"center"},a.createElement(k,{room:n,roomAvatar:ie,onChangeAvatar:Se})),a.createElement(s,null,a.createElement(s.Label,null,H("Name")),a.createElement(s.Row,null,a.createElement(d,{disabled:!He,value:le,onChange:Ae,flexGrow:1}))),Ue&&a.createElement(s,null,a.createElement(s.Label,null,H("Description")),a.createElement(s.Row,null,a.createElement(b,{rows:4,value:de,onChange:De,flexGrow:1}))),qe&&a.createElement(s,null,a.createElement(s.Label,null,H("Announcement")),a.createElement(s.Row,null,a.createElement(b,{rows:4,value:me,onChange:je,flexGrow:1}))),We&&a.createElement(s,null,a.createElement(s.Label,null,H("Topic")),a.createElement(s.Row,null,a.createElement(b,{rows:4,value:se,onChange:Te,flexGrow:1}))),Ve&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,H("Private")),a.createElement(s.Row,null,a.createElement(u,{disabled:!nn,checked:"p"===oe,onChange:fn}))),a.createElement(s.Hint,null,H("Just_invited_people_can_access_this_channel"))),ze&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,H("Read_only")),a.createElement(s.Row,null,a.createElement(u,{disabled:!tn,checked:ae,onChange:Pe}))),a.createElement(s.Hint,null,H("Only_authorized_users_can_write_new_messages"))),Qe&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,H("React_when_read_only")),a.createElement(s.Row,null,a.createElement(u,{disabled:!ln,checked:ue,onChange:Oe}))),a.createElement(s.Hint,null,H("Only_authorized_users_can_write_new_messages"))),Je&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,H("Archived")),a.createElement(s.Row,null,a.createElement(u,{disabled:!an,checked:ce,onChange:Me})))),Ke&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,H("Password_to_access")),a.createElement(s.Row,null,a.createElement(u,{checked:he,onChange:ge}))),a.createElement(s.Row,null,a.createElement(m,{disabled:!he,value:Ee,onChange:be,placeholder:H("Reset_password"),flexGrow:1}))),Ye&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,H("Hide_System_Messages")),a.createElement(s.Row,null,a.createElement(u,{checked:pe,onChange:ke}))),a.createElement(s.Row,null,a.createElement(E,{maxWidth:"100%",options:te,disabled:!pe,value:ye,onChange:_e,placeholder:H("Select_an_option"),flexGrow:1}))),Xe&&a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,H("Encrypted")),a.createElement(s.Row,null,a.createElement(u,{disabled:!cn,checked:re,onChange:ve})))),z&&a.createElement(h,null,a.createElement(h.Item,{title:H("Prune")},a.createElement(f,null,a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,H("RetentionPolicyRoom_Enabled")),a.createElement(s.Row,null,a.createElement(u,{checked:fe,onChange:Ne})))),a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,H("RetentionPolicyRoom_OverrideGlobal")),a.createElement(s.Row,null,a.createElement(u,{disabled:!fe||!on,checked:Re,onChange:Le})))),Re&&a.createElement(a.Fragment,null,a.createElement(y,{type:"danger"},a.createElement(v,null,H("RetentionPolicyRoom_ReadTheDocs"))),a.createElement(s,null,a.createElement(s.Label,null,H("RetentionPolicyRoom_MaxAge",{max:Y})),a.createElement(s.Row,null,a.createElement(p,{value:xe,onChange:Rn,flexGrow:1}))),a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,H("RetentionPolicyRoom_ExcludePinned")),a.createElement(s.Row,null,a.createElement(u,{checked:we,onChange:Fe})))),a.createElement(s,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",flexGrow:1},a.createElement(s.Label,null,H("RetentionPolicyRoom_FilesOnly")),a.createElement(s.Row,null,a.createElement(u,{checked:Ce,onChange:Be})))))))),a.createElement(s,null,a.createElement(s.Row,null,a.createElement(w,{display:"flex",flexDirection:"row",justifyContent:"space-between",w:"full"},a.createElement(x,{stretch:!0,flexGrow:1},a.createElement(R,{type:"reset",disabled:!$,onClick:ee},H("Reset")),a.createElement(R,{flexGrow:1,disabled:!$,onClick:hn},H("Save")))))),a.createElement(s,null,a.createElement(s.Row,null,a.createElement(R,{flexGrow:1,primary:!0,danger:!0,disabled:!rn,onClick:pn},a.createElement(C,{name:"trash",size:"x16"}),H("Delete"))))))}t.exportDefault(U)}

