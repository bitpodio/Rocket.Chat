function module(e,a,t){let s,n,r,l,i,o,u,d,c,m,f,k,p,v,h,_,E,b,x,g,y,A,U;function w(e){let{uid:a}=e,t=r(e,["uid"]);const s=v(),{value:o,phase:u,error:c}=A("roles.list",""),{value:m,phase:f,error:p}=A("users.info",i(()=>({userId:a}),[a]));return[f,u].includes(U.LOADING)?l.createElement(d,{p:"x24"},l.createElement(y,null)):p||c?l.createElement(k,{m:"x16",type:"danger"},s("User_not_found")):l.createElement(C,n({data:m.user,roles:o.roles},t))}t.link("@babel/runtime/helpers/objectSpread2",{default(e){s=e}},0),t.link("@babel/runtime/helpers/extends",{default(e){n=e}},1),t.link("@babel/runtime/helpers/objectWithoutProperties",{default(e){r=e}},2),t.export({EditUserWithData:()=>w,EditUser:()=>C}),t.link("react",{default(e){l=e},useMemo(e){i=e},useState(e){o=e},useCallback(e){u=e}},0),t.link("@rocket.chat/fuselage",{Box(e){d=e},Field(e){c=e},Margins(e){m=e},Button(e){f=e},Callout(e){k=e}},1),t.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){p=e}},2),t.link("../../../contexts/TranslationContext",{useTranslation(e){v=e}},3),t.link("../../../hooks/useEndpointAction",{useEndpointAction(e){h=e}},4),t.link("../../../hooks/useEndpointUpload",{useEndpointUpload(e){_=e}},5),t.link("../../../contexts/RouterContext",{useRoute(e){E=e}},6),t.link("../../../components/avatar/UserAvatarEditor",{default(e){b=e}},7),t.link("../../../hooks/useForm",{useForm(e){x=e}},8),t.link("./UserForm",{default(e){g=e}},9),t.link("../../../components/Skeleton",{FormSkeleton(e){y=e}},10),t.link("../../../hooks/useEndpointData",{useEndpointData(e){A=e}},11),t.link("../../../hooks/useAsyncState",{AsyncStatePhase(e){U=e}},12);const T=e=>{var a,t,s,n,r;return{roles:e.roles,name:null!==(a=e.name)&&void 0!==a?a:"",password:"",username:e.username,status:e.status,bio:null!==(t=e.bio)&&void 0!==t?t:"",nickname:null!==(s=e.nickname)&&void 0!==s?s:"",email:e.emails&&e.emails[0].address||"",verified:e.emails&&e.emails[0].verified||!1,setRandomPassword:!1,requirePasswordChange:e.setRandomPassword||!1,customFields:null!==(n=e.customFields)&&void 0!==n?n:{},statusText:null!==(r=e.statusText)&&void 0!==r?r:""}};function C(e){let{data:a,roles:t}=e,k=r(e,["data","roles"]);const y=v(),[A,U]=o(),[w,C]=o({}),S={name:e=>C(a=>s(s({},a),{},{name:e.trim().length?void 0:y("The_field_is_required",y("name"))})),username:e=>C(a=>s(s({},a),{},{username:e.trim().length?void 0:y("The_field_is_required",y("username"))})),email:e=>C(a=>s(s({},a),{},{email:e.trim().length?void 0:y("The_field_is_required",y("email"))}))},P=e=>{let{key:a,value:t}=e;S[a]&&S[a](t)},{values:F,handlers:R,reset:I,hasUnsavedChanges:O}=x(T(a),P),j=E("admin-users"),D=u(e=>j.push({context:"info",id:e}),[j]),q=i(()=>({userId:a._id,data:F}),[a._id,F]),G=i(()=>({userId:a._id,avatarUrl:A&&A.avatarUrl}),[a._id,A]),M=i(()=>({userId:a._id}),[a._id]),B=h("POST","users.update",q,y("User_updated_successfully")),W=_("users.setAvatar",G,y("Avatar_changed_successfully")),H=h("POST","users.setAvatar",G,y("Avatar_changed_successfully")),L=h("POST","users.resetAvatar",M,y("Avatar_changed_successfully")),N=u(async()=>"reset"===A?L():A.avatarUrl?H():(A.set("userId",a._id),W(A)),[A,L,W,H,a._id]),V=p(async()=>{Object.entries(F).forEach(e=>{let[a,t]=e;S[a]&&S[a](t)});const{name:e,username:t,email:s}=F;if(""===e||""===t||""===s)return!1;const n=await B();n.success&&(A&&await N(),D(a._id))},[A,a._id,D,B,N,F,w,S]),z=t.map(e=>{let{_id:a,description:t}=e;return[a,t||a]}),J=O||A,K=i(()=>l.createElement(b,{currentUsername:a.username,username:F.username,etag:a.avatarETag,setAvatarObj:U}),[a.username,a.avatarETag,F.username]),Q=i(()=>l.createElement(c,null,l.createElement(c.Row,null,l.createElement(d,{display:"flex",flexDirection:"row",justifyContent:"space-between",w:"full"},l.createElement(m,{inlineEnd:"x4"},l.createElement(f,{flexGrow:1,type:"reset",disabled:!J,onClick:I},y("Reset")),l.createElement(f,{mie:"none",flexGrow:1,disabled:!J,onClick:V},y("Save")))))),[V,J,I,y]);return l.createElement(g,n({errors:w,formValues:F,formHandlers:R,availableRoles:z,prepend:K,append:Q},k))}}

