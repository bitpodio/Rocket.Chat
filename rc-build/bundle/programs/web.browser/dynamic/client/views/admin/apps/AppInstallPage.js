function module(e,l,t){let n,a,i,o,r,s,c,p,u,m,d,E,f,k,x,h,F,w,g,C,y,_,b;t.link("@rocket.chat/fuselage",{Button(e){n=e},ButtonGroup(e){a=e},Icon(e){i=e},Field(e){o=e},FieldGroup(e){r=e},TextInput(e){s=e},Throbber(e){c=e}},0),t.link("react",{default(e){p=e},useCallback(e){u=e},useEffect(e){m=e},useState(e){d=e}},1),t.link("../../../components/Page",{default(e){E=e}},2),t.link("../../../contexts/RouterContext",{useRoute(e){f=e},useQueryStringParameter(e){k=e}},3),t.link("../../../contexts/ServerContext",{useEndpoint(e){x=e},useUpload(e){h=e}},4),t.link("../../../contexts/TranslationContext",{useTranslation(e){F=e}},5),t.link("../../../hooks/useFileInput",{useFileInput(e){w=e}},6),t.link("../../../hooks/useForm",{useForm(e){g=e}},7),t.link("./helpers",{handleInstallError(e){C=e}},8),t.link("./AppPermissionsReviewModal",{default(e){y=e}},9),t.link("../../../contexts/ModalContext",{useSetModal(e){_=e}},10),t.link("./lib/getPermissionsFromZippedApp",{getPermissionsFromZippedApp(e){b=e}},11);const I="https://rocket.chat/apps/package.zip";function S(){const e=F(),l=f("admin-apps"),t=_(),S=k("id"),A=k("url"),[P,v]=d(!1),z=S?"/apps/".concat(S):"/apps",R=x("POST",z),T=h(z),{values:U,handlers:D}=g({file:{},url:A}),{file:B,url:M}=U,O=!!M||!!B.name,{handleFile:G,handleUrl:L}=D;m(()=>{A&&L(A)},[A,L]);const[Z]=w(G,"app"),H=async(e,n)=>{const a=new FormData;a.append("app",n,n.name),a.append("permissions",JSON.stringify(e));const{app:i}=await T(a);l.push({context:"details",id:i.id}),t(null)},J=u(()=>{v(!1),t(null)},[v,t]),N=async()=>{v(!0);try{let e,l;if(M){const{buff:t}=await R({url:M,downloadOnly:!0}),n=Uint8Array.from(t.data);e=await b(n),l=new File([n],"app.zip",{type:"application/zip"})}else l=B,e=await b(l);e&&0!==e.length?t(p.createElement(y,{appPermissions:e,cancel:J,confirm:e=>H(e,l)})):await H(e,l)}catch(e){C(e)}finally{v(!1)}},Q=()=>{l.push()};return p.createElement(E,{flexDirection:"column"},p.createElement(E.Header,{title:e("App_Installation")}),p.createElement(E.ScrollableContent,null,p.createElement(r,{display:"flex",flexDirection:"column",alignSelf:"center",maxWidth:"x600",w:"full"},p.createElement(o,null,p.createElement(o.Label,null,e("App_Url_to_Install_From")),p.createElement(o.Row,null,p.createElement(s,{placeholder:I,value:M,onChange:L,addon:p.createElement(i,{name:"permalink",size:"x20"})}))),p.createElement(o,null,p.createElement(o.Label,null,e("App_Url_to_Install_From_File")),p.createElement(o.Row,null,p.createElement(s,{value:B.name||"",addon:p.createElement(n,{small:!0,primary:!0,onClick:Z,mb:"neg-x4",mie:"neg-x8"},p.createElement(i,{name:"upload",size:"x12"}),e("Browse_Files"))}))),p.createElement(o,null,p.createElement(a,null,p.createElement(n,{disabled:!O||P,onClick:N},!P&&e("Install"),P&&p.createElement(c,{inheritColor:!0})),p.createElement(n,{onClick:Q},e("Cancel")))))))}t.exportDefault(S)}

