function module(e,n,t){let a,l,r,c,o,s,i,d,m,u,p,h,E,y,_,C,b,x,g,f,k,D,v,w;t.export({CreateChannel:()=>T}),t.link("meteor/kadira:flow-router",{FlowRouter(e){a=e}},0),t.link("react",{default(e){l=e},memo(e){r=e},useCallback(e){c=e},useEffect(e){o=e},useMemo(e){s=e},useState(e){i=e}},1),t.link("@rocket.chat/fuselage-hooks",{useMutableCallback(e){d=e},useDebouncedCallback(e){m=e}},2),t.link("@rocket.chat/fuselage",{Box(e){u=e},Modal(e){p=e},ButtonGroup(e){h=e},Button(e){E=e},TextInput(e){y=e},Icon(e){_=e},Field(e){C=e},ToggleSwitch(e){b=e}},3),t.link("../../contexts/TranslationContext",{useTranslation(e){x=e}},4),t.link("../../hooks/useForm",{useForm(e){g=e}},5),t.link("../../hooks/useEndpointAction",{useEndpointActionExperimental(e){f=e}},6),t.link("../../../ee/client/audit/UserAutoCompleteMultiple",{default(e){k=e}},7),t.link("../../contexts/SettingsContext",{useSetting(e){D=e}},8),t.link("../../contexts/AuthorizationContext",{usePermission(e){v=e}},9),t.link("../../contexts/ServerContext",{useMethod(e){w=e}},10);const T=e=>{let{values:n,handlers:t,hasUnsavedChanges:a,onChangeUsers:r,onChangeType:c,onChangeBroadcast:d,canOnlyCreateOneType:g,e2eEnabledForPrivateByDefault:f,onCreate:v,onClose:T}=e;const O=x(),B=D("E2E_Enable"),F=D("UTF8_Names_Validation"),P=D("UI_Allow_room_names_with_special_chars"),R=w("roomNameExists"),S=s(()=>{if(P)return"";const e=new RegExp("^".concat(F,"$"));return e},[P,F]),[U,I]=i(),A=m(async e=>{if(I(!1),a)return;if(!e||0===e.length)return I(O("Field_required"));if(!S.test(e))return I(O("error-invalid-name"));const n=await R(e);return n?I(O("Channel_already_exist",e)):void 0},100,[name]);o(()=>{A(n.name)},[A,n.name]);const L=s(()=>!n.type||n.broadcast||!B||f,[B,f,n.broadcast,n.type]),N=s(()=>a&&!U,[a,U]);return l.createElement(p,null,l.createElement(p.Header,null,l.createElement(p.Title,null,O("Create_channel")),l.createElement(p.Close,{onClick:T})),l.createElement(p.Content,null,l.createElement(C,{mbe:"x24"},l.createElement(C.Label,null,O("Name")),l.createElement(C.Row,null,l.createElement(y,{error:a?U:void 0,addon:l.createElement(_,{name:n.type?"lock":"hash",size:"x20"}),placeholder:O("Channel_name"),onChange:t.handleName})),a&&U&&l.createElement(C.Error,null,U)),l.createElement(C,{mbe:"x24"},l.createElement(C.Label,null,O("Topic")," ",l.createElement(u,{is:"span",color:"neutral-600"},"(",O("optional"),")")),l.createElement(C.Row,null,l.createElement(y,{placeholder:O("Channel_what_is_this_channel_about"),onChange:t.handleDescription}))),l.createElement(C,{mbe:"x24"},l.createElement(u,{display:"flex",justifyContent:"space-between",alignItems:"start"},l.createElement(u,{display:"flex",flexDirection:"column"},l.createElement(C.Label,null,O("Private")),l.createElement(C.Description,null,n.type?O("Only_invited_users_can_acess_this_channel"):O("Everyone_can_access_this_channel"))),l.createElement(b,{checked:n.type,disabled:!!g,onChange:c}))),l.createElement(C,{mbe:"x24",disabled:n.broadcast},l.createElement(u,{display:"flex",justifyContent:"space-between",alignItems:"start"},l.createElement(u,{display:"flex",flexDirection:"column"},l.createElement(C.Label,null,O("Read_only")),l.createElement(C.Description,null,O("All_users_in_the_channel_can_write_new_messages"))),l.createElement(b,{checked:n.readOnly,disabled:n.broadcast,onChange:t.handleReadOnly}))),l.createElement(C,{disabled:L,mbe:"x24"},l.createElement(u,{display:"flex",justifyContent:"space-between",alignItems:"start"},l.createElement(u,{display:"flex",flexDirection:"column"},l.createElement(C.Label,null,O("Encrypted")),l.createElement(C.Description,null,n.type?O("Encrypted_channel_Description"):O("Encrypted_not_available"))),l.createElement(b,{checked:n.encrypted,disabled:L,onChange:t.handleEncrypted}))),l.createElement(C,{mbe:"x24"},l.createElement(u,{display:"flex",justifyContent:"space-between",alignItems:"start"},l.createElement(u,{display:"flex",flexDirection:"column"},l.createElement(C.Label,null,O("Broadcast")),l.createElement(C.Description,null,O("Broadcast_channel_Description"))),l.createElement(b,{checked:n.broadcast,onChange:d}))),l.createElement(C,{mbe:"x24"},l.createElement(C.Label,null,"".concat(O("Add_members")," (").concat(O("optional"),")")),l.createElement(k,{value:n.users,onChange:r}))),l.createElement(p.Footer,null,l.createElement(h,{align:"end"},l.createElement(E,{onClick:T},O("Cancel")),l.createElement(E,{disabled:!N,onClick:v,primary:!0},O("Create")))))};t.exportDefault(r(e=>{let{onClose:n}=e;const t=f("POST","channels.create"),r=f("POST","groups.create"),o=f("POST","channels.setDescription"),i=f("POST","groups.setDescription"),m=v("create-c"),u=v("create-p"),p=D("E2E_Enabled_Default_PrivateRooms"),h=s(()=>!m&&u?"p":!(!m||u)&&"c",[m,u]),E={users:[],name:"",description:"",type:!h||"p"===h,readOnly:!1,encrypted:null!=p&&p,broadcast:!1},{values:y,handlers:_,hasUnsavedChanges:C}=g(E),{users:b,name:x,description:k,type:w,readOnly:O,broadcast:B,encrypted:F}=y,{handleUsers:P,handleEncrypted:R,handleType:S,handleBroadcast:U,handleReadOnly:I}=_,A=d((e,n)=>{if(!n){if(b.includes(e))return;return P([...b,e])}P(b.filter(n=>n!==e))}),L=d(e=>(R(!e),S(e))),N=d(e=>(R(!e),I(e),U(e))),M=c(async()=>{const e=e=>{a.goToRoomById(e)},l={name:x,members:b,readOnly:O,extraData:{broadcast:B,encrypted:F}};let c;e(w?(c=await r(l)).group._id:(c=await t(l)).channel._id),c.success&&c.group&&k?i({description:k,roomName:c.group.name}):c.success&&c.channel&&k&&o({description:k,roomName:c.channel.name}),n()},[B,t,r,k,F,x,n,O,o,i,w,b]);return l.createElement(T,{values:y,handlers:_,hasUnsavedChanges:C,onChangeUsers:A,onChangeType:L,onChangeBroadcast:N,canOnlyCreateOneType:h,e2eEnabledForPrivateByDefault:p,onClose:n,onCreate:M})}))}

