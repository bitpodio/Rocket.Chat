function module(e,t,n){let a,s,o,i,r,l,c,d,u,m,h,f,g,y,p,S,k;n.export({NewUsersSection:()=>b}),n.link("@nivo/bar",{ResponsiveBar(e){a=e}},0),n.link("@rocket.chat/fuselage",{Box(e){s=e},Flex(e){o=e},Select(e){i=e},Skeleton(e){r=e},ActionButton(e){l=e}},1),n.link("@rocket.chat/fuselage-hooks",{useResizeObserver(e){c=e}},2),n.link("moment",{default(e){d=e}},3),n.link("react",{default(e){u=e},useMemo(e){m=e},useState(e){h=e}},4),n.link("../../../../../../client/contexts/TranslationContext",{useTranslation(e){f=e}},5),n.link("../../../../../../client/hooks/useEndpointData",{useEndpointData(e){g=e}},6),n.link("../../../../../../client/hooks/useFormatDate",{useFormatDate(e){y=e}},7),n.link("../../../../../../client/components/data/CounterSet",{default(e){p=e}},8),n.link("../Section",{Section(e){S=e}},9),n.link("../../../../../../client/lib/download",{downloadCsvAs(e){k=e}},10);const x=45;function b(){const e=f(),t=m(()=>[["last 7 days",e("Last_7_days")],["last 30 days",e("Last_30_days")],["last 90 days",e("Last_90_days")]],[e]),[n,b]=h("last 7 days"),E=y(),v=m(()=>{switch(n){case"last 7 days":return{start:d().set({hour:0,minute:0,second:0,millisecond:0}).subtract(7,"days"),end:d().set({hour:0,minute:0,second:0,millisecond:0}).subtract(1)};case"last 30 days":return{start:d().set({hour:0,minute:0,second:0,millisecond:0}).subtract(30,"days"),end:d().set({hour:0,minute:0,second:0,millisecond:0}).subtract(1)};case"last 90 days":return{start:d().set({hour:0,minute:0,second:0,millisecond:0}).subtract(90,"days"),end:d().set({hour:0,minute:0,second:0,millisecond:0}).subtract(1)}}},[n]),w=e=>b(e),_=m(()=>({start:v.start.toISOString(),end:v.end.toISOString()}),[v]),{value:I}=g("engagement-dashboard/users/new-users",_),{ref:U,contentBoxSize:{inlineSize:C=600}={}}=c(),A=Math.ceil(C/x),D=m(()=>{const e=d(v.end).diff(v.start,"days")+1;if(e<=A||!A)return null;const t=Array.from({length:e},(e,t)=>d(v.start).add(t,"days").toISOString()),n=Math.ceil(t.length/A);return t.reduce((e,t,a)=>((a+1)%n==0&&(e=[...e,t]),e),[])},[v,A]),[M,R,z,B,F]=m(()=>{if(!I)return[];const e=Array.from({length:d(v.end).diff(v.start,"days")+1},(e,t)=>({date:d(v.start).add(t,"days").toISOString(),newUsers:0}));for(const{day:t,users:n}of I.days){const a=d(t).diff(v.start,"days");a>=0&&(e[a].newUsers+=n)}return[I.period.count,I.period.variation,I.yesterday.count,I.yesterday.variation,e]},[I,v]),O=()=>{const e=F.map(e=>{let{data:t,newUsers:n}=e;return[t,n]});k(e,"NewUsersSection_start_".concat(_.start,"_end_").concat(_.end))};return u.createElement(S,{title:e("New_users"),filter:u.createElement(u.Fragment,null,u.createElement(i,{small:!0,options:t,value:n,onChange:w}),u.createElement(l,{small:!0,mis:"x16",disabled:!I,onClick:O,"aria-label":e("Download_Info"),icon:"download"}))},u.createElement(p,{counters:[{count:I?M:u.createElement(r,{variant:"rect",width:"3ex",height:"1em"}),variation:I?R:0,description:t.find(e=>{let[t]=e;return t===n})[1]},{count:I?z:u.createElement(r,{variant:"rect",width:"3ex",height:"1em"}),variation:I?B:0,description:e("Yesterday")}]}),u.createElement(o.Container,null,I?u.createElement(s,{style:{height:240}},u.createElement(o.Item,{align:"stretch",grow:1,shrink:0},u.createElement(s,{style:{position:"relative"},ref:U},u.createElement(s,{style:{position:"absolute",width:"100%",height:"100%"}},u.createElement(a,{data:F,indexBy:"date",keys:["newUsers"],groupMode:"grouped",padding:.25,margin:{bottom:20,left:20,top:20},colors:["#1d74f5"],enableLabel:!1,enableGridY:!1,axisTop:null,axisRight:null,axisBottom:{tickSize:0,tickPadding:4,tickRotation:0,tickValues:D,format:e=>d(e).format(7===F.length?"dddd":"DD/MM")},axisLeft:{tickSize:0,tickPadding:4,tickRotation:0},animate:!0,motionStiffness:90,motionDamping:15,theme:{axis:{ticks:{text:{fill:"#9EA2A8",fontFamily:'Inter, -apple-system, system-ui, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Helvetica Neue", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Meiryo UI", Arial, sans-serif',fontSize:"10px",fontStyle:"normal",fontWeight:"600",letterSpacing:"0.2px",lineHeight:"12px"}}},tooltip:{container:{backgroundColor:"#1F2329",boxShadow:"0px 0px 12px rgba(47, 52, 61, 0.12), 0px 0px 2px rgba(47, 52, 61, 0.08)",borderRadius:2}}},tooltip:t=>{let{value:n,indexValue:a}=t;return(u.createElement(s,{fontScale:"p2",color:"alternative"},e("Value_users",{value:n}),", ",E(a)))}}))))):u.createElement(s,{ref:U},u.createElement(r,{variant:"rect",height:240}))))}}

